package go.christian.steptracker;

import org.junit.Test;

import java.util.List;

import static org.junit.Assert.*;

/**
 * Example local unit test, which will execute on the development machine (host).
 *
 * @see <a href="http://d.android.com/tools/testing">Testing documentation</a>
 */
public class SensorTests {
  private int runStepCounterOnData(String data) {
    List<Accelerometer.Event> events = SensorDataExporter.importFromString(data);

    StepCounter stepCounter = StepCounterFactory.GetStepCounter();

    for (Accelerometer.Event event : events) {
      float[] valuesArray = new float[] {event.x, event.y, event.z};
      stepCounter.addData(valuesArray);
    }

    return stepCounter.getStepCount();
  }

  @Test
  public void bigSteps_4() {
    String data =
        "timestamp,x,y,z\n840201266495290,-0.21068975,0.7469909,8.283937\n840201331506228,-0.31603462,-0.17238252,8.446744\n840201396484353,-0.91937345,0.61291564,7.9966335\n840201461493728,0.19153613,-0.02873042,8.025364\n840201526503103,-3.5529952,0.31603462,11.597513\n840201591512478,-0.90021986,-0.90021986,9.184157\n840201656490603,-1.9057846,-1.0821792,9.998186\n840201721501540,-0.8331822,-1.7621324,8.734048\n840201786510915,-3.169923,-0.7757214,10.103531\n840201851489040,-2.873042,-1.8674773,10.984597\n840201916498415,-5.171476,-0.019153614,9.32781\n840201981507790,-5.1810527,-1.541866,10.611102\n840202046485915,-7.795521,-0.47884035,9.433155\n840202111495290,-5.4779334,-2.2697031,9.279925\n840202176504665,-6.2728086,-1.5705963,7.393295\n840202241484353,-4.1946416,-2.72939,8.724471\n840202306493728,-6.8569937,-1.3790601,8.389283\n840202371503103,-7.192182,-1.292869,6.090849\n840202436512478,-7.4603324,-1.7238252,6.9527617\n840202501490603,-8.389283,-1.091756,6.5505357\n840202566499978,-5.6982,-2.432509,6.5026517\n840202631509353,-8.111555,-1.436521,5.9759274\n840202696489040,-8.762778,-1.9057846,3.016694\n840202761498415,-8.973468,-2.566584,5.085284\n840202826507790,-8.283937,-2.3750482,4.098873\n840202891485915,-11.81778,-0.63206923,4.2042184\n840202956495290,-7.881712,-2.9113493,-0.11492168\n840203021504665,-10.534488,-3.074155,-0.94810385\n840203086514040,-7.6710224,-4.280833,-0.7278373\n840203151493728,-6.6654577,-5.66947,-2.767697\n840203216503103,-11.520899,-3.5051112,-2.4133554\n840203281512478,-4.807557,-7.2209125,-2.5091233\n840203346490603,-10.94629,-5.0757074,-1.5131354\n840203411499978,-5.2480903,-8.954314,-2.0973208\n840203476509353,-9.643845,-7.8050976,-3.217807\n840203541487478,-5.995081,-7.28795,-7.1730285\n840203606498415,-6.205771,-6.349423,-5.0661306\n840203671507790,-4.5681367,-6.3111157,-1.6184803\n840203736485915,-2.6431987,-4.1276035,-1.6567876\n840203801495290,-0.36391866,-4.1659107,2.0111294\n840203866504665,-1.13964,-30.004135,4.2425256\n840203931515603,-3.3614593,-6.5218053,-0.25857377\n840203996493728,5.3821654,-9.251195,2.719813\n840204061503103,2.6623523,-9.883265,-0.61291564\n840204126512478,1.2066777,-9.404425,1.4460979\n840204191490603,1.3694834,-9.662998,0.49799395\n840204256499978,1.4460979,-9.5385,1.1683705\n840204321509353,1.2641385,-9.519346,0.78529817\n840204386487478,1.6663644,-9.883265,-0.22984336\n840204451496853,2.1260512,-9.662998,-0.16280572\n840204516507790,2.0590134,-9.471462,0.16280572\n840204581485915,1.436521,-9.490616,0.39264908\n840204646495290,0.63206923,-9.634268,0.5650316\n840204711504665,-0.24899697,-9.969456,0.49799395\n840204776514040,-0.17238252,-9.701305,0.63206923\n840204841492165,1.5993267,-9.758766,1.0342951\n840204906501540,-0.38307226,-9.270349,0.62249243\n840204971512478,-0.06703765,-9.509769,-0.06703765\n840205036490603,-0.41180268,-9.423578,0.545878\n840205101499978,-0.59376204,-9.471462,1.0726024\n840205166509353,-0.45010993,-9.385271,2.4612393\n840205231487478,0.4405331,-10.228029,2.1068976\n840205296496853,0.58418524,-10.965444,2.432509\n840205361507790,-2.0207062,-13.560759,4.7500963\n840205426485915,1.1300632,-14.001291,1.2737153\n840205491493728,-0.93852705,-11.166556,2.2888567\n840205556504665,1.7908629,-11.425131,1.7429788\n840205621514040,3.9360676,-12.612655,-0.6895301\n840205686492165,1.3215994,-9.615114,1.2641385\n840205751503103,0.41180268,-8.408437,-1.0534488\n840205816512478,0.33518824,-7.2687964,-0.58418524\n840205881490603,0.8714894,-5.085284,-1.0247183\n840205946498415,2.1547816,-6.0716953,-3.9743748\n840206011509353,4.2521024,-9.021352,-5.631162\n840206076487478,4.1659107,-8.341399,-4.865018\n840206141496853,8.169016,-9.940725,-9.940725\n840206206506228,-5.6982,-5.171476,17.24783\n840206271484353,6.244078,-5.755661,0.6703765\n840206336493728,2.5761611,-9.270349,-3.7732618\n840206401504665,4.7022123,-10.927136,-0.5363012\n840206466514040,2.7102363,-9.643845,-0.1436521\n840206531492165,0.5650316,-10.342952,-0.48841715\n840206596501540,-0.9672575,-8.322245,-1.8483237\n840206661510915,-0.5554548,-8.743625,0.30645782\n840206726489040,0.12449849,-8.925584,-0.37349546\n840206791498415,0.5267244,-10.0269165,1.7908629\n840206856509353,-0.7086837,-11.032481,4.462792\n840206921487478,0.1340753,-11.434708,2.528277\n840206986496853,-0.545878,-11.013328,2.6623523\n840207051506228,1.6184803,-14.690822,3.6104562\n840207116484353,5.985504,-13.627796,0.39264908\n840207181493728,4.1659107,-14.058752,1.1204864\n840207246504665,2.327164,-11.319786,2.825158\n840207311514040,-0.641646,-7.192182,0.076614454\n840207376492165,-0.6799533,-4.7022123,-0.095768064\n840207441501540,-0.9864111,-3.4572272,1.733402\n840207506510915,4.711789,-5.707777,-6.14831\n840207571489040,6.540959,-7.4986396,-4.4819455\n840207636498415,6.1100025,-6.579266,-6.5218053\n840207701507790,23.27164,-19.632454,-11.568783\n840207766487478,0.59376204,4.309563,-5.209783\n840207831496853,6.4260373,-19.182344,-2.27928\n840207896506228,3.6870706,-7.297527,-3.5529952\n840207961484353,4.711789,-9.710882,-4.357447\n840208026493728,5.6790466,-6.493075,-2.1452048\n840208091504665,4.960786,-8.6574335,-2.8921957\n840208156514040,1.9919758,-9.040505,-1.1587936\n840208221490603,1.2066777,-10.879252,-0.93852705\n840208286501540,0.30645782,-9.921572,-2.4899697\n840208351510915,0.48841715,-9.595961,-2.2218192\n840208416489040,1.2162545,-9.442732,-0.4405331\n840208481498415,2.0015526,-10.266336,-0.49799395\n840208546507790,1.2258313,-9.222465,0.92895025\n840208611487478,1.9057846,-9.203311,1.4748282\n840208676496853,3.9552212,-11.013328,1.2641385\n840208741506228,3.265691,-10.237606,-1.4652514\n840208806484353,2.6240451,-6.9240313,2.135628\n840208871493728,4.6926355,-9.059659,-1.0055647\n840208936504665,3.41892,-10.936713,-3.0933087\n840209001512478,1.6280571,-9.078813,0.047884032\n840209066490603,2.336741,-9.126697,-0.35434186\n840209131501540,4.3861775,-10.869676,-1.9632454\n840209196510915,2.2505496,-7.8912888,-2.0398598\n840209261489040,2.7868507,-9.433155,-0.92895025\n840209326498415,2.3463178,-8.504205,-1.1300632\n840209391509353,2.8443117,-10.01734,-1.6472107\n840209456485915,2.0015526,-9.040505,-1.685518\n840209521496853,1.5801731,-9.375694,-1.7046716\n840209586506228,0.45968673,-11.36767,-2.0398598\n840209651484353,1.1013328,-11.243171,0.38307226\n840209716493728,0.40222588,-9.414001,-2.920926\n840209781503103,-2.336741,-9.500193,-0.6895301\n840209846512478,-0.82360536,-10.965444,-3.9264908\n840209911490603,0.46926352,-9.80665,-2.2409728\n840209976501540,-1.8579005,-10.01734,-2.0685902\n840210041510915,-2.3080103,-9.528923,-1.8579005\n840210106489040,-3.1028855,-10.151415,-0.91937345\n840210171498415,-3.4284968,-10.151415,-2.3175871\n840210236509353,-1.436521,-8.791509,-2.6240451\n840210301485915,-7.833828,-7.1634517,-0.8810662\n840210366496853,-3.8594532,-7.4986396,-2.3463178\n840210431506228,-6.1004257,-9.040505,-0.12449849\n840210496484353,-5.142745,-9.873688,-2.432509\n840210561493728,-5.995081,-7.3645644,-2.681506\n840210626503103,-9.078813,-6.129156,-0.8619126\n840210691512478,-7.5561004,-7.8625584,1.7717092\n840210756490603,-8.37013,-5.841852,-1.091756\n840210821501540,-11.894394,-4.76925,4.060566\n840210886510915,-10.524911,-1.6472107,3.9552212\n840210951489040,-9.854534,-0.9959879,8.485051\n840211016498415,-6.8091097,-0.23942018,5.5737014\n840211081507790,-5.2863975,-1.1779473,7.747637\n840211146485915,-4.7788267,-0.4405331,7.2304893\n840211211495290,-4.6830587,-1.1683705,8.839393\n840211276504665,-4.405331,0.30645782,7.785944\n840211341484353,-3.0933087,1.3599066,7.699753\n840211406493728,-3.514688,1.8387469,6.8569937\n840211471503103,-2.5378537,2.72939,9.174581\n840211536512478,-1.9632454,2.633622,7.8912888\n840211601490603,-4.357447,4.146757,8.446744\n840211666501540,-2.528277,1.3790601,9.56723\n840211731509353,-2.5761611,5.4204726,-10.70687\n840211796489040,1.8100165,4.050989,11.21444\n840211861496853,0.11492168,2.566584,7.8050976\n840211926507790,0.8331822,3.5913026,10.601525\n840211991485915,-0.23942018,3.7445314,9.040505\n840212056495290,-0.20111294,4.185065,8.7053175\n840212121506228,0.36391866,3.6774938,9.509769\n";

    assertEquals(4, runStepCounterOnData(data));
  }

  @Test
  public void fastBigSteps_10() {
    String data =
        "timestamp,x,y,z\n840234816492165,-0.5746084,1.4460979,9.155427\n840234881501540,-0.5554548,2.0111294,8.293514\n840234946510915,-1.0247183,0.7374141,10.572795\n840235011489040,0.35434186,2.3558946,6.493075\n840235076498415,-0.81402856,1.541866,10.515334\n840235141507790,0.37349546,0.32561144,7.489063\n840235206485915,-0.49799395,0.8714894,10.314221\n840235271495290,-3.514688,0.41180268,10.821792\n840235336506228,0.02873042,-1.6950948,8.274361\n840235401484353,-0.15322891,-1.5801731,11.923124\n840235466493728,-0.19153613,-1.4939818,11.63582\n840235531503103,-2.5570073,0.5363012,12.77546\n840235596512478,-1.2449849,-0.47884035,10.764331\n840235661490603,-1.2641385,-1.4556746,12.028469\n840235726501540,-1.9536686,-0.35434186,11.300632\n840235791510915,-2.2888567,-1.1875241,10.907983\n840235856489040,-1.9919758,-0.91937345,9.816227\n840235921498415,-1.5705963,-1.3215994,10.726024\n840235986507790,-1.5131354,-1.2066777,10.342952\n840236051485915,-1.8100165,-1.2066777,9.394848\n840236116495290,-1.7142484,-1.3694834,9.490616\n840236181506228,-1.6280571,-1.4173675,9.3661175\n840236246484353,-1.9536686,-0.5267244,9.624691\n840236311493728,-1.6280571,-1.4939818,10.486604\n840236376503103,-2.327164,-0.8619126,10.5919485\n840236441512478,-1.7429788,-1.2258313,10.275913\n840236506490603,-2.336741,-1.0247183,10.113108\n840236571501540,-2.0973208,-1.1013328,8.858546\n840236636510915,-2.1164744,-1.0630256,9.346964\n840236701489040,-1.6663644,-1.4652514,10.189722\n840236766496853,-1.8195933,-0.90021986,9.691729\n840236831507790,-2.0590134,-1.043872,10.352529\n840236896485915,-1.7142484,-0.90021986,9.404425\n840236961495290,-2.0207062,-0.7565677,9.394848\n840237026504665,-1.0342951,-1.3982137,9.653421\n840237091484353,-1.0055647,-0.45010993,7.431602\n840237156493728,-4.405331,-0.19153613,10.0748005\n840237221503103,-5.2863975,-1.0726024,8.781932\n840237286512478,-6.0238113,-1.4652514,6.4739213\n840237351490603,-13.445837,0.5267244,5.00867\n840237416501540,-7.632715,-1.4460979,-0.02873042\n840237481509353,-7.9104424,-3.3423057,-1.436521\n840237546487478,-9.222465,-3.821146,-0.5267244\n840237611498415,-14.939818,-6.895301,-2.9017725\n840237676507790,-8.015787,-5.209783,-3.0454245\n840237741485915,-7.881712,-4.271256,-1.0247183\n840237806495290,-2.825158,-5.0757074,-2.528277\n840237871504665,-10.1226845,-4.807557,-0.34476504\n840237936514040,-6.3685765,-9.069236,2.231396\n840238001492165,-12.200851,-6.157887,-2.6048915\n840238066503103,-4.1180267,-4.309563,-3.3806129\n840238131512478,-6.215348,-6.751649,7.8050976\n840238196490603,-3.0358477,-3.4955344,-1.5801731\n840238261499978,-1.5131354,-5.085284,4.1180267\n840238326510915,-12.899959,-21.021091,2.566584\n840238391487478,0.49799395,-6.655881,0.8619126\n840238456498415,-1.7046716,-10.91756,-1.6759412\n840238521507790,-2.6910827,-9.586384,0.6991069\n840238586485915,-1.7429788,-9.701305,0.9959879\n840238651495290,-2.585738,-9.423578,0.095768064\n840238716506228,-2.825158,-9.461885,1.1204864\n840238781514040,-2.4708161,-10.065224,0.2873042\n840238846492165,-2.27928,-9.155427,0.9864111\n840238911503103,-2.6144683,-9.126697,2.1547816\n840238976512478,-2.566584,-9.634268,2.0590134\n840239041490603,-1.7908629,-9.662998,0.20111294\n840239106499978,-1.7429788,-10.151415,0.009576807\n840239171509353,-2.9975405,-9.404425,0.7374141\n840239236489040,-2.9017725,-9.509769,1.4748282\n840239301498415,-2.0207062,-9.701305,0.38307226\n840239366507790,-2.1452048,-9.576807,1.13964\n840239431485915,-2.3463178,-9.5385,0.9576807\n840239496495290,-2.327164,-9.576807,0.45968673\n840239561504665,-2.4612393,-9.586384,0.46926352\n840239626514040,-2.2505496,-9.701305,0.11492168\n840239691492165,-2.1068976,-9.519346,-0.02873042\n840239756501540,-2.2697031,-9.519346,0.019153614\n840239821510915,-2.327164,-9.490616,-0.45010993\n840239886490603,-2.1260512,-9.548077,-0.25857377\n840239951499978,-2.1164744,-9.528923,-0.50757074\n840240016510915,-2.1643584,-9.414001,-0.4405331\n840240081487478,-2.4612393,-9.452309,-0.35434186\n840240146496853,-4.711789,-9.040505,0.32561144\n840240211506228,-2.9783869,-9.586384,-0.16280572\n840240276485915,-2.5474305,-8.810662,-0.545878\n840240341493728,-3.1028855,-8.820239,-0.17238252\n840240406504665,-2.9592333,-8.475474,0.06703765\n840240471514040,-3.7445314,-9.088389,1.3215994\n840240536492165,-3.083732,-10.419566,0.33518824\n840240601501540,-4.0222588,-9.682152,3.3327289\n840240666512478,-3.4380736,-11.444284,3.1890767\n840240731490603,-8.111555,-14.317327,-2.4420857\n840240796499978,-4.855441,-11.60709,-2.566584\n840240861509353,-2.3558946,-14.058752,-0.19153613\n840240926487478,-0.6703765,-13.953407,-1.9536686\n840240991496853,-4.7022123,-9.80665,4.050989\n840241056507790,0.24899697,-7.038953,2.4516625\n840241121485915,-1.2066777,-3.41892,2.4995465\n840241186493728,0.5554548,-2.834735,-5.5641246\n840241251504665,6.4164605,-16.481684,-8.101978\n840241316514040,5.707777,-12.593501,3.715801\n840241381492165,-3.8977604,-2.8443117,-0.05746084\n840241446501540,-3.8977604,-14.978126,7.824251\n840241511510915,-7.881712,-11.453861,-8.379706\n840241576489040,-1.5801731,-7.642292,0.34476504\n840241641498415,-2.0207062,-6.885724,0.6895301\n840241706509353,-1.5514427,-12.469003,0.6512229\n840241771487478,-5.861006,-12.77546,-0.31603462\n840241836496853,-9.873688,-13.187263,1.7525556\n840241901506228,-0.4309563,-12.98615,4.012682\n840241966484353,3.9360676,-22.620419,0.38307226\n840242031493728,1.3215994,-10.649409,2.1930888\n840242096503103,-1.0630256,-4.146757,3.1411927\n840242161514040,-0.92895025,-2.825158,1.7238252\n840242226492165,-2.585738,-3.7541082,2.585738\n840242291501540,7.086837,-12.334928,-20.465635\n840242356510915,10.534488,-10.7356,-15.897499\n840242421489040,6.8186865,-6.4164605,2.2218192\n840242486498415,-0.20111294,-11.022904,11.415554\n840242551509353,-2.681506,-16.989256,2.2505496\n840242616487478,-4.5872903,-6.3685765,-4.6926355\n840242681496853,-2.030283,-7.431602,1.5897499\n840242746506228,0.9959879,-10.323798,-19.057846\n840242811485915,-3.821146,-13.560759,1.2737153\n840242876495290,-8.264784,-12.449849,-3.3135753\n840242941504665,0.7374141,-13.713987,-9.576807\n840243006514040,2.1260512,-15.629349,4.1180267\n840243071492165,6.081272,-19.421764,0.0\n840243136501540,-1.3599066,-6.445191,6.0716953\n840243201510915,-0.63206923,-2.3175871,1.9440918\n840243266489040,-2.528277,-2.8921957,6.5601125\n840243331498415,3.4955344,-5.659893,-12.440272\n840243396507790,5.8226986,-11.60709,-2.6431987\n840243461487478,4.999093,-4.865018,2.882619\n840243526495290,-2.0398598,-8.983045,14.671668\n840243591506228,-3.4572272,-19.64203,4.462792\n840243656484353,-5.45878,-10.093954,-5.2768207\n840243721493728,-1.1013328,-5.353435,0.22984336\n840243786503103,-2.1164744,-7.565677,2.1930888\n840243851512478,-2.2026656,-13.541605,0.49799395\n840243916490603,-8.149862,-12.727576,-3.572149\n840243981501540,-8.37013,-14.5759,4.7979803\n840244046510915,0.7182605,-14.920665,5.7269306\n840244111489040,7.9870567,-24.152706,4.4436383\n840244176498415,-2.6240451,-6.397307,5.0757074\n840244241507790,-1.436521,-0.8619126,2.3750482\n840244306485915,-2.4708161,-2.2601264,6.742072\n840244371496853,2.528277,-8.331821,-16.156073\n840244436506228,6.5505357,-9.490616,-2.3175871\n840244501484353,-1.4748282,-3.6104562,11.951855\n840244566493728,2.2026656,-9.835381,14.470555\n840244631503103,-2.3175871,-20.417751,2.6719291\n840244696512478,-7.0485296,-9.481039,-2.7581203\n840244761490603,-2.3750482,-4.644751,-0.45968673\n840244826499978,-2.2601264,-7.872135,-0.45010993\n840244891510915,-5.0374002,-12.583924,-0.60333884\n840244956489040,-9.643845,-12.363658,-3.0454245\n840245021498415,-6.6175733,-11.415554,7.1826053\n840245086507790,0.7661445,-15.7825775,4.5777135\n840245151487478,7.345411,-22.505495,1.8195933\n840245216495290,-2.135628,-6.3206925,4.7309427\n840245281504665,-0.23942018,-1.8483237,3.4763808\n840245346484353,-1.9632454,-2.8060043,5.707777\n840245411493728,1.7621324,-5.6407394,-8.025364\n840245476503103,6.8282633,-11.856087,-6.4164605\n840245541512478,2.930503,-12.928689,12.440272\n840245606490603,-6.981492,-6.8091097,10.984597\n840245671499978,2.3463178,-20.63802,-9.902418\n840245736510915,0.49799395,-7.881712,2.0398598\n840245801489040,-1.6759412,-8.963891,-6.205771\n840245866498415,0.6703765,-7.881712,-1.3311762\n840245931507790,3.9743748,-8.676587,0.019153614\n840245996485915,-1.6089035,-13.40753,1.6663644\n840246061495290,0.35434186,-9.050082,1.2258313\n840246126504665,0.4213795,-11.224017,4.0222588\n840246191484353,0.9768343,-8.236053,3.1794999\n840246256493728,2.2026656,-9.797073,0.8331822\n840246321503103,1.3790601,-9.730036,-0.45968673\n840246386512478,0.82360536,-10.5440645,-0.038307227\n840246451490603,3.667917,-10.898406,2.1452048\n840246516499978,2.8538885,-7.5561004,2.3942018\n840246581510915,0.63206923,-9.557653,3.7828386\n840246646489040,0.7469909,-9.672575,2.8060043\n840246711498415,-0.7565677,-10.505757,0.22026655\n840246776507790,1.8674773,-8.283937,2.3558946\n840246841485915,3.8115692,-10.093954,-1.0821792\n840246906495290,0.80445176,-8.829816,2.5187001\n840246971504665,2.4133554,-10.275913,2.2122424\n840247036515603,0.34476504,-10.093954,1.1587936\n840247101493728,1.8962077,-8.2169,-0.038307227\n840247166503103,1.982399,-9.691729,1.0630256\n840247231512478,-0.80445176,-7.824251,2.336741\n840247296490603,-2.2601264,-9.902418,3.265691\n840247361499978,-0.8523358,-9.739613,0.047884032\n840247426509353,-2.2888567,-9.030929,0.19153613\n840247491487478,-0.78529817,-10.362105,0.59376204\n840247556496853,-2.1643584,-9.720459,0.92895025\n840247621507790,-2.2888567,-9.519346,3.2465374\n840247686485915,-5.0182467,-8.149862,-1.1492168\n840247751495290,-4.2425256,-8.992621,0.6607997\n840247816504665,-3.9073372,-9.519346,0.6991069\n840247881514040,-4.6830587,-9.921572,-0.94810385\n840247946492165,-4.156334,-9.5385,1.436521\n840248011501540,-5.793968,-8.868123,-1.2162545\n840248076512478,-5.6407394,-7.7667904,-1.541866\n840248141490603,-5.841852,-8.580819,-0.41180268\n840248206499978,-5.506664,-8.24563,-0.02873042\n840248271509353,-7.422025,-7.651869,-0.047884032\n840248336487478,-8.054094,-8.178593,1.0821792\n840248401496853,-9.768343,-5.985504,1.7525556\n840248466507790,-13.206416,-3.217807,1.6089035\n840248531485915,-12.124237,-1.1013328,4.2042184\n840248596495290,-8.37013,-1.2066777,7.8912888\n840248661506228,-7.2783732,-0.7661445,6.7612257\n840248726514040,-4.9416323,-2.2026656,9.394848\n840248791492165,-4.098873,-0.4309563,5.48751\n840248856503103,-3.715801,-0.4405331,6.6654577\n840248921512478,-1.5801731,-1.541866,10.0748005\n840248986490603,-4.5298295,2.777274,7.517793\n840249051499978,-2.719813,1.2162545,9.394848\n840249116509353,-2.6910827,2.0494366,9.069236\n840249181487478,-2.6048915,2.633622,8.6574335\n840249246496853,-1.8962077,2.96881,9.078813\n840249311506228,-2.5761611,3.4859576,7.699753\n840249376484353,-1.9440918,3.6391866,7.651869\n840249441493728,-2.0111294,3.7924154,7.872135\n840249506504665,-1.6376339,3.371036,9.615114\n840249571514040,-2.0685902,4.3382936,8.475474\n840249636492165,-1.7717092,4.0222588,9.107543\n840249701503103,-2.0015526,4.31914,7.929596\n840249766512478,-1.6472107,4.0701427,8.8777\n840249831490603,-1.9536686,4.213795,8.925584\n840249896499978,-1.7621324,4.3382936,8.925584\n840249961509353,-1.8100165,4.7022123,7.575254\n";

    assertEquals(10, runStepCounterOnData(data));
  }

  @Test
  public void fastSmallSteps_16() {
    String data =
        "timestamp,x,y,z\n840268811512478,-0.47884035,2.585738,8.475474\n840268876489040,0.32561144,2.681506,11.022904\n840268941499978,-0.5650316,2.327164,9.059659\n840269006509353,-0.34476504,2.3080103,10.0269165\n840269071487478,-0.38307226,2.7581203,8.283937\n840269136496853,-1.5131354,2.336741,7.575254\n840269201506228,-1.8483237,1.9440918,6.4547677\n840269266484353,-1.283292,1.1875241,9.385271\n840269331495290,-0.7757214,-1.043872,7.9008656\n840269396504665,-4.6830587,1.6472107,9.260772\n840269461514040,1.6472107,-1.7429788,6.157887\n840269526492165,-3.8977604,0.9768343,11.60709\n840269591501540,-1.484405,-0.46926352,8.178593\n840269656512478,-3.7924154,-0.90021986,14.144943\n840269721490603,-2.183512,-0.6799533,11.769896\n840269786499978,-5.142745,0.59376204,11.329363\n840269851509353,-3.4572272,-0.6703765,8.628703\n840269916487478,-8.312668,0.038307227,8.37013\n840269981496853,-9.873688,0.63206923,4.912902\n840270046507790,-10.160992,-0.50757074,2.6240451\n840270111484353,-8.724471,-2.2409728,1.4652514\n840270176495290,-7.8146744,-3.4093432,0.4405331\n840270241504665,-7.575254,-3.1986535,-1.3024458\n840270306514040,-12.823344,-1.484405,-0.79487497\n840270371492165,-7.9008656,-4.654328,-3.0550013\n840270436501540,-9.481039,-5.0278234,-1.1683705\n840270501512478,-8.983045,-7.067683,-2.6048915\n840270566489040,-5.401319,-6.6654577,-5.056554\n840270631498415,-2.336741,-7.144298,-1.3599066\n840270696509353,-1.8195933,-4.280833,-0.4405331\n840270761487478,-3.4763808,-32.44622,-4.31914\n840270826496853,-4.223372,-7.1730285,0.6799533\n840270891506228,3.1794999,-8.42759,4.759673\n840270956484353,5.45878,-10.237606,-2.920926\n840271021495290,1.7621324,-9.222465,0.39264908\n840271086503103,0.58418524,-9.959879,1.0055647\n840271151512478,0.12449849,-9.5385,-0.22026655\n840271216492165,0.2873042,-9.509769,0.19153613\n840271281501540,0.038307227,-9.557653,1.1779473\n840271346510915,-0.50757074,-9.787497,1.7621324\n840271411489040,0.7182605,-9.691729,0.19153613\n840271476498415,0.40222588,-9.500193,-0.45968673\n840271541509353,-0.6703765,-9.232041,1.7142484\n840271606531228,-0.31603462,-10.0748005,1.4460979\n840271671496853,0.61291564,-11.15698,-1.043872\n840271736506228,-1.292869,-12.53604,-1.1013328\n840271801484353,-3.0933087,-14.33648,-7.7093296\n840271866495290,0.9672575,-10.630256,6.081272\n840271931503103,1.6567876,-17.60217,-13.694834\n840271996514040,0.45010993,-6.9144545,1.484405\n840272061492165,1.0726024,-4.865018,2.585738\n840272126501540,1.733402,-4.280833,-0.34476504\n840272191510915,4.76925,-14.901511,-16.682798\n840272256489040,4.2904096,-10.850522,7.0581064\n840272321498415,0.93852705,-5.803545,7.2592196\n840272386509353,-0.545878,-12.679692,-0.30645782\n840272451485915,-1.283292,-9.088389,0.34476504\n840272516495290,0.91937345,-10.247183,-1.7621324\n840272581506228,-0.16280572,-9.519346,-2.8921957\n840272646484353,-4.357447,-13.196839,-4.003105\n840272711493728,-0.63206923,-14.211981,-10.658986\n840272776503103,0.8714894,-14.757859,7.383718\n840272841514040,1.9728222,-13.254301,-2.5474305\n840272906490603,-0.20111294,-2.1739352,3.0550013\n840272971501540,1.9440918,-4.4436383,4.4244847\n840273036510915,2.384625,-5.851429,-0.8810662\n840273101489040,1.2737153,-12.459426,-8.90643\n840273166498415,2.4516625,-9.050082,3.8402996\n840273231507790,3.2561142,-10.218452,2.9592333\n840273296485915,-0.33518824,-12.373235,-1.1109096\n840273361495290,-1.0630256,-7.335834,0.9864111\n840273426506228,-0.40222588,-8.839393,-1.733402\n840273491484353,-1.1013328,-12.315774,-1.8387469\n840273556493728,-4.9703627,-17.238253,-4.1946416\n840273621503103,-0.7757214,-11.233594,4.865018\n840273686514040,5.3821654,-20.887016,-3.1507695\n840273751490603,1.2449849,-3.6870706,3.0454245\n840273816501540,-0.047884032,-2.183512,3.016694\n840273881510915,2.4708161,-4.55856,3.2273839\n840273946489040,8.1402855,-20.264523,-28.902803\n840274011498415,1.6089035,-9.883265,9.509769\n840274076509353,2.2505496,-8.686164,0.22984336\n840274141485915,0.38307226,-13.168109,1.1300632\n840274206495290,-1.8770541,-8.599973,0.8619126\n840274271504665,1.532289,-8.6574335,-3.5434184\n840274336484353,-1.1300632,-13.244724,-5.9280434\n840274401493728,-4.7884035,-16.184803,-6.033388\n840274466503103,-1.6663644,-11.013328,6.0525417\n840274531512478,3.0071173,-19.785683,-4.2425256\n840274596490603,1.0630256,-2.5091233,3.1507695\n840274661499978,-0.05746084,-2.2026656,3.122039\n840274726509353,2.9975405,-5.449203,1.7621324\n840274791487478,4.2521024,-12.421119,-11.559206\n840274856498415,3.5338416,-13.589489,7.1634517\n840274921507790,2.7581203,-9.011775,2.5091233\n840274986485915,0.7182605,-13.110648,2.4420857\n840275051495290,-1.685518,-8.485051,-0.25857377\n840275116504665,0.47884035,-7.776367,-1.7717092\n840275181482790,-0.2777274,-13.091495,-5.707777\n840275246492165,-3.7062242,-17.717093,-6.991069\n840275311503103,-0.89064306,-11.57836,5.6790466\n840275376512478,3.5242648,-19.067423,-4.405331\n840275441490603,1.0055647,-2.528277,2.384625\n840275506499978,-0.82360536,-2.5378537,4.185065\n840275571509353,3.1986535,-5.5258174,1.9919758\n840275636489040,3.8307228,-13.062764,-17.448942\n840275701496853,1.4460979,-8.619126,5.305551\n840275766507790,3.1986535,-9.720459,1.3790601\n840275831485915,0.2681506,-11.626244,-1.5993267\n840275896495290,-1.6950948,-8.561666,1.2737153\n840275961506228,1.484405,-9.892841,-2.4995465\n840276026515603,0.7469909,-11.674128,-5.21936\n840276091492165,-4.8841715,-17.650055,-7.97748\n840276156503103,0.02873042,-11.109096,5.4683566\n840276221512478,7.2783732,-20.887016,-3.821146\n840276286490603,1.2545617,-3.3997664,3.2561142\n840276351499978,-0.9672575,-2.2505496,3.6391866\n840276416509353,1.9153614,-4.606444,4.367024\n840276481487478,2.7868507,-14.863204,-14.757859\n840276546496853,3.4763808,-11.405977,5.631162\n840276611507790,4.4340615,-10.457873,3.2369606\n840276676485915,-0.06703765,-13.67568,3.2369606\n840276741495290,0.10534488,-8.101978,-1.1300632\n840276806504665,0.7086837,-8.686164,0.038307227\n840276871514040,-0.9672575,-12.124237,-2.5570073\n840276936492165,-2.3750482,-18.109741,-6.1866174\n840277001503103,-0.58418524,-10.1226845,4.9799395\n840277066510915,6.435614,-20.762518,-1.4269443\n840277131490603,-0.5746084,-3.8115692,3.6487634\n840277196499978,-1.0151415,-3.1507695,2.8921957\n840277261509353,0.8331822,-4.012682,3.6870706\n840277326487478,9.174581,-21.499931,-23.051374\n840277391496853,1.7046716,-10.04607,9.069236\n840277456507790,2.1547816,-5.841852,1.2354081\n840277521485915,0.49799395,-12.4785795,3.1316159\n840277586495290,-2.030283,-10.141838,-0.8523358\n840277651504665,0.51714754,-8.532935,-1.091756\n840277716514040,3.2082303,-11.022904,-10.955867\n840277781492165,-4.76925,-14.81532,-4.501099\n840277846501540,1.2258313,-11.425131,3.5051112\n840277911512478,5.8226986,-19.488802,-0.82360536\n840277976490603,0.7469909,-5.0278234,2.6431987\n840278041499978,-1.1971009,-4.213795,2.681506\n840278106509353,0.9959879,-2.8634653,4.2999864\n840278171487478,11.233594,-19.718645,-25.139118\n840278236496853,3.2465374,-18.626888,10.275913\n840278301506228,-0.9672575,-4.012682,7.3645644\n840278366485915,1.8483237,-14.709975,5.5162406\n840278431493728,-0.9576807,-7.920019,3.3614593\n840278496504665,1.685518,-9.471462,-5.363012\n840278561514040,1.3503298,-7.680599,1.1779473\n840278626492165,2.030283,-8.552089,-0.9576807\n840278691501540,0.8523358,-8.523358,1.7046716\n840278756510915,2.432509,-9.548077,1.436521\n840278821490603,3.964798,-8.42759,0.90021986\n840278886498415,0.33518824,-10.371682,5.3247046\n840278951509353,2.3463178,-9.950302,0.8714894\n840279016487478,1.2066777,-9.940725,0.79487497\n840279081496853,3.8115692,-9.069236,1.091756\n840279146507790,5.2289367,-8.379706,3.1316159\n840279211484353,2.815581,-8.7532015,1.7525556\n840279276493728,2.9879637,-9.040505,3.2369606\n840279341504665,1.4460979,-11.15698,-0.45968673\n840279406514040,2.920926,-8.37013,-4.4340615\n840279471490603,1.6472107,-10.496181,0.7278373\n840279536501540,2.7389667,-9.797073,0.05746084\n840279601510915,-2.336741,-8.7532015,-0.9959879\n840279666489040,-0.6991069,-11.137826,0.6991069\n840279731498415,-3.2752678,-11.616667,0.38307226\n840279796509353,-4.146757,-7.192182,-1.8674773\n840279861487478,-4.2904096,-9.3182335,-1.340753\n840279926496853,-2.6527755,-10.6877165,-0.08619126\n840279991507790,-4.8745947,-9.77792,-0.15322891\n840280056485915,-5.257667,-8.686164,-1.2545617\n840280121493728,-5.1906295,-9.854534,-0.23942018\n840280186504665,-6.339846,-6.7803793,-0.62249243\n840280251512478,-4.6351743,-8.973468,0.19153613\n840280316492165,-6.3111157,-8.082825,1.2641385\n840280381501540,-6.751649,-7.1059904,0.019153614\n840280446510915,-9.787497,-8.303091,3.8786068\n840280511489040,-11.262324,-4.6830587,1.9057846\n840280576498415,-9.988609,-3.074155,5.104438\n840280641507790,-7.479486,-2.8060043,7.4028716\n840280706487478,-5.48751,-3.2082303,8.025364\n840280771496853,-5.094861,-3.074155,8.599973\n840280836506228,-5.4779334,-1.9057846,8.264784\n840280901484353,-4.0892963,-2.2026656,9.050082\n840280966493728,-5.257667,-0.4309563,8.00621\n840281031504665,-4.663905,0.7374141,7.9104424\n840281096514040,-4.146757,0.7374141,8.762778\n840281161492165,-1.7525556,1.0821792,8.66701\n840281226501540,-1.9536686,2.0685902,7.9391727\n840281291510915,-0.89064306,0.2777274,8.868123\n840281356489040,-3.3614593,1.9440918,11.60709\n840281421498415,-0.9768343,1.2737153,9.797073\n840281486507790,-1.6759412,2.2984335,8.101978\n840281551487478,-2.6144683,2.2026656,8.121132\n840281616496853,-2.2888567,2.3463178,9.873688\n840281681506228,-2.5474305,2.0207062,9.80665\n840281746484353,-1.3024458,3.3423057,8.025364\n840281811493728,-1.3790601,2.5187001,10.055647\n840281876503103,-0.81402856,2.9592333,8.829816\n840281941512478,-0.81402856,2.6719291,9.643845\n840282006490603,-0.23942018,3.4572272,9.442732\n840282071501540,-0.6703765,3.1603463,9.634268\n840282136510915,-0.7757214,3.1316159,10.342952\n840282201489040,-0.35434186,2.882619,9.988609\n";

    assertEquals(16, runStepCounterOnData(data));
  }

  @Test
  public void steps_5() {
    String data =
        "timestamp,x,y,z\n840093701495290,-1.532289,1.043872,9.059659\n840093766506228,-0.8619126,0.24899697,7.872135\n840093831484353,-2.528277,1.292869,9.241618\n840093896493728,-0.4405331,-0.47884035,10.007763\n840093961503103,-1.5993267,0.7182605,9.078813\n840094026512478,-2.4899697,1.283292,8.197746\n840094091490603,-0.6703765,-1.043872,10.362105\n840094156499978,-2.6623523,0.7278373,9.394848\n840094221510915,-2.2026656,0.6991069,12.124237\n840094286487478,-1.7717092,-0.18195933,11.415554\n840094351498415,-2.681506,0.81402856,11.300632\n840094416507790,-3.8977604,0.1436521,12.200851\n840094481485915,-3.7828386,1.13964,8.590396\n840094546495290,-5.209783,-0.641646,7.6135616\n840094611504665,-6.943185,-0.21068975,6.655881\n840094676514040,-8.714894,-1.091756,7.747637\n840094741493728,-8.331821,-0.20111294,1.5801731\n840094806503103,-8.236053,-1.3790601,2.231396\n840094871512478,-9.490616,-1.3311762,-0.08619126\n840094936490603,-10.371682,-2.5953147,0.7661445\n840095001499978,-7.8912888,-6.5601125,0.22984336\n840095066509353,-8.149862,-6.4260373,-2.2122424\n840095131487478,-3.2082303,-7.422025,-6.483498\n840095196498415,-12.315774,-3.41892,2.5378537\n840095261507790,-5.1235914,-10.7356,-7.795521\n840095326485915,-9.155427,-5.746084,-2.9783869\n840095391495290,-4.3478703,-4.5681367,-3.6870706\n840095456504665,-2.5187001,-5.985504,-2.5187001\n840095521514040,-2.767697,-5.094861,1.283292\n840095586493728,-7.0581064,-14.911088,-2.6623523\n840095651501540,-4.654328,-13.397953,-0.33518824\n840095716512478,0.47884035,-7.2304893,2.4899697\n840095781490603,-0.2681506,-11.032481,1.9728222\n840095846499978,-0.16280572,-9.548077,1.2641385\n840095911510915,-0.59376204,-9.998186,1.3503298\n840095976487478,-0.60333884,-9.528923,1.9728222\n840096041496853,-0.82360536,-9.548077,1.0821792\n840096106506228,-2.1930888,-9.308656,2.4708161\n840096171485915,-2.6240451,-9.739613,2.0685902\n840096236495290,-0.90021986,-9.461885,0.842759\n840096301504665,-2.0398598,-9.404425,2.6527755\n840096366514040,-1.5610195,-9.126697,1.292869\n840096431492165,-1.4077905,-9.691729,1.4460979\n840096496501540,-2.3175871,-11.405977,2.4037786\n840096561512478,-3.2944214,-11.808203,1.1204864\n840096626490603,-3.4859576,-11.769896,-3.5913026\n840096691499978,-0.12449849,-11.520899,-1.4077905\n840096756509353,-0.11492168,-12.440272,3.7541082\n840096821487478,-0.545878,-11.559206,-0.59376204\n840096886496853,-1.1300632,-7.422025,1.9536686\n840096951507790,0.29688102,-7.536947,1.2641385\n840097016485915,1.4652514,-5.2002063,1.484405\n840097081495290,0.30645782,-6.1004257,-5.449203\n840097146504665,1.4173675,-13.953407,-8.590396\n840097211514040,7.575254,-18.330008,-7.747637\n840097276492165,-2.7102363,2.1643584,9.921572\n840097341501540,3.1028855,-8.1402855,5.3438582\n840097406512478,-2.384625,-15.20797,0.9864111\n840097471490603,-4.003105,-9.710882,0.8714894\n840097536499978,-2.2026656,-7.4986396,1.6663644\n840097601509353,1.388637,-11.128249,-6.6654577\n840097666487478,-0.33518824,-10.304645,0.24899697\n840097731496853,-4.405331,-10.927136,1.3694834\n840097796506228,-6.3781533,-15.495274,-3.5817258\n840097861484353,-1.5035586,-9.739613,5.889736\n840097926495290,2.96881,-19.6133,3.2848446\n840097991504665,1.934515,-8.887277,3.4572272\n840098056514040,-0.93852705,-5.2863975,1.7812861\n840098121492165,0.2681506,-5.1810527,2.2697031\n840098186501540,1.1683705,-3.8594532,2.1547816\n840098251512478,3.466804,-15.160085,-17.54471\n840098316490603,6.981492,-9.653421,-2.1930888\n840098381498415,3.9073372,-6.789956,9.969456\n840098446509353,1.091756,-6.1387334,7.249643\n840098511487478,-3.083732,-16.443377,1.6950948\n840098576496853,-3.0933087,-6.3111157,-10.362105\n840098641506228,-2.719813,-8.896853,2.1643584\n840098706484353,0.60333884,-8.7053175,-4.2425256\n840098771493728,-0.4213795,-10.457873,1.1109096\n840098836504665,-2.6719291,-10.927136,0.9576807\n840098901514040,-5.6215854,-8.082825,0.9768343\n840098966492165,4.4244847,-14.326903,14.805743\n840099031501540,3.5338416,-14.652514,6.38773\n840099096510915,6.933608,-14.020445,-8.446744\n840099161489040,1.0055647,-10.429143,4.4819455\n840099226498415,0.02873042,-4.7022123,3.0550013\n840099291509353,-0.1340753,-8.485051,-0.59376204\n840099356487478,3.169923,-10.821792,-3.8881836\n840099421496853,5.391742,-7.479486,2.6623523\n840099486506228,2.7102363,-7.881712,1.4556746\n840099551484353,-0.16280572,-9.844957,-2.2505496\n840099616493728,0.78529817,-8.619126,-0.019153614\n840099681503103,3.5913026,-9.921572,-1.6376339\n840099746514040,3.6774938,-10.773908,-1.0726024\n840099811492165,1.6280571,-8.992621,0.095768064\n840099876501540,1.4939818,-10.007763,0.5554548\n840099941510915,2.9496565,-9.078813,-0.34476504\n840100006489040,2.2409728,-10.103531,-1.6280571\n840100071498415,1.3599066,-9.14585,0.8810662\n840100136509353,2.3080103,-10.534488,0.02873042\n840100201487478,1.340753,-8.6095495,-0.6512229\n840100266496853,2.767697,-9.624691,-3.0550013\n840100331506228,2.873042,-9.414001,-1.685518\n840100396484353,2.183512,-9.749189,-2.2984335\n840100461493728,2.4229321,-10.333375,-0.4213795\n840100526503103,3.3614593,-9.720459,-1.4652514\n840100591512478,2.336741,-9.337387,-2.7102363\n840100656492165,3.265691,-8.1881695,-0.12449849\n840100721501540,1.8004397,-9.548077,-1.6184803\n840100786510915,3.8402996,-8.734048,-5.209783\n840100851489040,3.667917,-9.394848,-0.9864111\n840100916498415,1.7046716,-8.820239,-4.0892963\n840100981507790,3.1124623,-9.040505,-3.371036\n840101046485915,2.7102363,-9.030929,-2.2505496\n840101111496853,2.9975405,-9.241618,-2.4229321\n840101176506228,3.1028855,-9.749189,-3.2273839\n840101241484353,3.3423057,-8.331821,-2.1452048\n840101306493728,2.96881,-7.4028716,-2.930503\n840101371504665,1.5610195,-10.582372,-1.6376339\n840101436514040,1.2162545,-12.354081,-2.0685902\n840101501490603,1.0630256,-8.456321,-2.4516625\n840101566501540,-2.719813,-9.576807,-3.2273839\n840101631510915,-2.2122424,-10.486604,-1.3503298\n840101696489040,-0.9768343,-10.113108,-3.3901896\n840101761498415,-2.0590134,-10.275913,-0.62249243\n840101826509353,-3.6008794,-8.743625,-2.7868507\n840101891485915,-4.7022123,-10.151415,-2.087744\n840101956495290,-5.6886234,-8.695741,-3.0262709\n840102021506228,-3.3901896,-9.56723,-4.405331\n840102086484353,-8.647857,-7.1826053,-1.0151415\n840102151493728,-3.5242648,-7.2783732,-4.0701427\n840102216503103,-8.082825,-7.038953,-1.0342951\n840102281512478,-7.73806,-5.889736,-2.9879637\n840102346490603,-9.730036,-6.3685765,2.6240451\n840102411501540,-11.750742,-4.8267107,-0.5650316\n840102476510915,-14.451402,0.92895025,2.0973208\n840102541489040,-10.448297,-1.5801731,6.7803793\n840102606498415,-8.00621,-0.21068975,4.501099\n840102671507790,-6.789956,0.80445176,4.6830587\n840102736485915,-7.6710224,-4.8937483,10.869676\n840102801495290,-2.5570073,1.2354081,6.847417\n840102866506228,-4.7500963,3.916914,8.925584\n840102931484353,-2.5570073,1.934515,8.207323\n840102996493728,-1.5610195,2.480393,9.078813\n840103061503103,-1.1971009,1.4077905,10.831368\n840103126512478,-1.3120226,4.2999864,7.28795\n840103191490603,-1.7908629,3.3039982,8.743625\n840103256499978,-0.81402856,2.9496565,9.203311\n840103321509353,-1.5610195,4.4819455,7.680599\n840103386489040,-1.2641385,3.9073372,8.015787\n840103451498415,-1.0247183,3.821146,9.193734\n840103516507790,-1.1587936,4.280833,8.341399\n840103581485915,-0.4213795,3.763685,8.935161\n840103646495290,-1.8004397,4.951209,7.785944\n840103711504665,-0.30645782,3.6104562,9.710882\n840103776484353,-1.283292,4.55856,8.446744\n840103841493728,-0.46926352,3.514688,9.595961\n840103906503103,-0.4309563,3.7349546,9.097966\n840103971512478,-0.39264908,3.8498764,8.90643\n840104036490603,-0.50757074,3.964798,9.107543\n840104101499978,-0.7182605,4.098873,9.433155\n840104166510915,-0.59376204,4.0414124,8.90643\n840104231489040,-0.6799533,4.10845,9.107543\n";
    assertEquals(5, runStepCounterOnData(data));
  }

  @Test
  public void steps_6() {
    String data =
        "timestamp,x,y,z\n839988661484353,-0.1436521,2.5378537,8.504205\n839988726492165,0.21068975,2.5953147,6.847417\n839988791503103,1.1109096,1.5897499,7.929596\n839988856512478,0.5363012,2.4708161,7.3166804\n839988921490603,2.2505496,3.9073372,9.241618\n839988986499978,-0.24899697,1.9153614,11.434708\n839989051509353,0.4405331,2.2122424,7.651869\n839989116489040,0.45968673,0.18195933,8.293514\n839989181498415,-0.9959879,1.0151415,7.6614456\n839989246507790,-1.3982137,0.6895301,5.631162\n839989311485915,-3.5242648,-0.641646,13.369223\n839989376495290,-4.10845,1.9728222,9.605537\n839989441504665,-5.9184666,0.35434186,11.042058\n839989506484353,-5.209783,0.9864111,8.456321\n839989571493728,-8.0445175,1.8579005,9.662998\n839989636503103,-9.203311,0.89064306,9.174581\n839989701512478,-10.821792,1.9440918,5.793968\n839989766490603,-10.524911,1.8579005,3.6870706\n839989831499978,-9.337387,-0.58418524,4.146757\n839989896509353,-8.485051,-1.6184803,2.087744\n839989961487478,-9.691729,-1.2737153,1.7429788\n839990026496853,-9.461885,-1.2737153,2.6910827\n839990091507790,-9.212888,-0.7565677,1.5897499\n839990156485915,-8.418014,-0.93852705,0.33518824\n839990221495290,-9.289502,-3.217807,-0.17238252\n839990286504665,-6.7803793,-3.41892,-1.5801731\n839990351514040,-9.854534,-5.746084,2.2697031\n839990416492165,-10.965444,-5.1140146,-1.2641385\n839990481503103,-8.820239,-5.851429,-3.6391866\n839990546512478,-4.405331,-8.90643,-2.719813\n839990611490603,-4.9320555,-7.1251445,-2.2409728\n839990676499978,-5.4683566,-7.9487495,-1.8004397\n839990741509353,-2.2218192,-2.9783869,2.5091233\n839990806487478,0.8714894,-21.183897,-5.899313\n839990871496853,-3.6296098,-10.783484,3.083732\n839990936507790,3.083732,-6.4643445,5.401319\n839991001485915,5.592855,-10.113108,-1.13964\n839991066495290,2.336741,-9.528923,-0.20111294\n839991131506228,1.6184803,-9.548077,1.2641385\n839991196515603,1.4460979,-9.672575,1.1013328\n839991261492165,0.92895025,-9.500193,1.043872\n839991326503103,0.7757214,-9.624691,0.641646\n839991391512478,1.3024458,-9.56723,0.34476504\n839991456490603,1.2737153,-9.32781,0.095768064\n839991521499978,1.0534488,-9.576807,0.545878\n839991586509353,1.1109096,-9.528923,0.5650316\n839991651487478,0.90979666,-9.5385,1.1204864\n839991716496853,0.90021986,-11.022904,1.043872\n839991781507790,-0.05746084,-13.867216,-1.3694834\n839991846485915,0.7182605,-11.042058,-5.439626\n839991911493728,2.9975405,-11.051635,-0.5554548\n839991976504665,4.309563,-13.062764,2.6719291\n839992041514040,1.1492168,-9.576807,-0.8810662\n839992106492165,1.1492168,-7.776367,0.51714754\n839992171503103,2.2984335,-7.422025,-0.20111294\n839992236510915,3.6774938,-4.6926355,-0.15322891\n839992301490603,2.27928,-7.3645644,-5.104438\n839992366499978,1.0630256,-12.459426,-8.418014\n839992431509353,4.7788267,-8.226477,-4.501099\n839992496487478,4.6160207,-14.18325,-3.1411927\n839992561496853,4.501099,-4.9416323,0.5746084\n839992626507790,2.0590134,-10.0748005,-0.7086837\n839992691485915,-1.9632454,-11.070788,-1.6089035\n839992756495290,0.59376204,-8.839393,0.2681506\n839992821504665,2.384625,-9.030929,0.047884032\n839992886514040,1.1492168,-9.576807,0.37349546\n839992951492165,1.8770541,-9.816227,-2.4612393\n839993016501540,-0.81402856,-11.262324,1.5514427\n839993081510915,-2.681506,-15.112201,-3.2369606\n839993146490603,2.480393,-10.812215,-6.9048777\n839993211499978,2.8443117,-13.599066,5.9567738\n839993276509353,5.4300494,-12.871228,-5.4683566\n839993341487478,1.5705963,-6.3685765,2.4229321\n839993406496853,1.6567876,-7.2304893,0.6703765\n839993471506228,3.5338416,-5.209783,1.340753\n839993536485915,3.7445314,-5.48751,-2.9113493\n839993601495290,2.2218192,-15.610195,-12.392388\n839993666504665,7.479486,-13.464991,-3.064578\n839993731514040,0.2681506,-1.8195933,12.047623\n839993796492165,4.5777135,-8.283937,4.7788267\n839993861501540,1.8387469,-13.206416,-1.0630256\n839993926510915,-0.7086837,-9.14585,0.30645782\n839993991489040,0.6607997,-8.1402855,-0.20111294\n839994056498415,1.8770541,-10.342952,0.41180268\n839994121509353,2.8634653,-9.662998,-2.0685902\n839994186487478,-0.2681506,-10.25676,-0.9576807\n839994251496853,-2.633622,-13.215993,-0.4213795\n839994316506228,3.0933087,-11.57836,-0.82360536\n839994381484353,6.7133417,-12.966996,6.1100025\n839994446495290,5.755661,-9.308656,2.9592333\n839994511503103,1.7908629,-4.4436383,0.22984336\n839994576514040,1.292869,-8.542512,-0.009576807\n839994641492165,3.2561142,-6.943185,-1.6567876\n839994706501540,2.1643584,-9.5385,-4.9703627\n839994771510915,3.5817258,-6.7803793,2.4899697\n839994836489040,5.9280434,-6.6271505,-6.751649\n839994901498415,4.817134,-17.927782,0.8619126\n839994966509353,3.4476504,-4.759673,1.8483237\n839995031487478,3.41892,-13.905523,-5.0757074\n839995096496853,3.5817258,-8.896853,-0.7374141\n839995161506228,2.873042,-8.1881695,-1.2737153\n839995226484353,2.3463178,-8.264784,-2.0015526\n839995291493728,4.606444,-9.385271,-0.2873042\n839995356503103,5.085284,-8.858546,-1.532289\n839995421514040,5.5258174,-9.040505,-1.0151415\n839995486492165,3.9073372,-8.073248,-1.6759412\n839995551501540,4.4436383,-8.350976,-3.074155\n839995616510915,6.1004257,-9.615114,-1.8291701\n839995681489040,2.9879637,-8.418014,-1.1013328\n839995746498415,4.462792,-8.293514,-2.1068976\n839995811509353,2.7581203,-8.159439,-3.8881836\n839995876487478,4.232949,-9.011775,-3.3901896\n839995941496853,5.9567738,-8.858546,-1.340753\n839996006506228,3.1028855,-8.322245,-3.4380736\n839996071484353,4.711789,-8.552089,-3.7349546\n839996136493728,5.793968,-8.159439,-3.1603463\n839996201503103,4.2904096,-7.5082164,-1.8579005\n839996266512478,1.0151415,-10.04607,-1.6567876\n839996331490603,6.2249246,-6.196194,0.30645782\n839996396501540,0.59376204,-8.628703,-1.1683705\n839996461510915,5.171476,-8.973468,-3.7062242\n839996526489040,4.8362875,-8.820239,-1.733402\n839996591498415,4.050989,-9.126697,-1.6280571\n839996656509353,5.2480903,-10.572795,-0.047884032\n839996721485915,3.323152,-10.25676,1.6759412\n839996786495290,2.432509,-9.059659,-1.3024458\n839996851506228,1.982399,-9.471462,-0.6799533\n839996916484353,0.11492168,-9.050082,-2.0398598\n839996981493728,2.1164744,-9.088389,0.009576807\n839997046503103,1.6950948,-8.8777,-0.24899697\n839997111512478,1.2258313,-10.1226845,-2.777274\n839997176492165,-1.5610195,-9.021352,-0.15322891\n839997241501540,0.51714754,-12.880805,-0.29688102\n839997306510915,0.7182605,-11.195287,-2.2601264\n839997371489040,0.15322891,-11.81778,-0.7374141\n839997436498415,-3.821146,-9.059659,-0.16280572\n839997501507790,-3.964798,-9.270349,-2.1930888\n839997566485915,-3.620033,-11.128249,-1.2066777\n839997631495290,-5.707777,-8.944737,-1.0342951\n839997696506228,-5.0661306,-7.153875,0.81402856\n839997761484353,-8.111555,-7.4124484,-1.3024458\n839997826493728,-7.8912888,-6.885724,1.5035586\n839997891503103,-9.595961,-5.1523223,5.315128\n839997956512478,-11.540052,-0.19153613,4.175488\n839998021490603,-10.113108,0.9959879,4.31914\n839998086501540,-0.62249243,1.6089035,5.2385135\n839998151510915,-2.6623523,1.6472107,9.346964\n839998216489040,-2.2122424,0.095768064,12.133814\n839998281498415,-2.4516625,-0.6799533,10.400413\n839998346507790,-1.6376339,2.0494366,8.350976\n839998411487478,-1.0821792,0.35434186,9.011775\n839998476495290,0.45968673,2.3750482,9.797073\n839998541504665,-0.047884032,4.060566,6.339846\n839998606484353,-0.48841715,2.5953147,10.04607\n839998671493728,-1.3120226,4.0797195,8.0924015\n839998736503103,-1.1013328,3.2944214,8.159439\n839998801512478,-0.545878,3.4284968,8.379706\n839998866490603,-1.6089035,4.5777135,8.456321\n839998931499978,-0.17238252,3.2082303,10.055647\n839998996509353,-1.292869,4.5872903,7.833828\n";

    assertEquals(6, runStepCounterOnData(data));
  }

  @Test
  public void steps_14() {
    String data =
        String.format(
            "timestamp,x,y,z\n839957656498415,-0.34476504,-2.0398598,8.848969\n839957721509353,-1.2258313,-2.2888567,10.67814\n839957786485915,-1.4460979,-0.49799395,8.360553\n839957851496853,-1.4077905,-0.79487497,8.169016\n839957916506228,-1.283292,-1.4460979,10.419566\n839957981484353,-1.3024458,-1.685518,9.787497\n839958046493728,-2.1260512,-0.46926352,10.46745\n839958111503103,-1.0055647,-0.9959879,9.11712\n839958176512478,-1.8579005,-0.8619126,7.2209125\n839958241492165,-3.8881836,-2.384625,9.758766\n839958306501540,-5.2385135,-2.231396,9.442732\n839958371510915,-4.510676,-3.3135753,9.299079\n839958436489040,-6.540959,-1.1971009,7.393295\n839958501498415,-4.9320555,-2.5187001,7.7189064\n839958566507790,-7.469909,-0.4405331,6.9623384\n839958631485915,-8.475474,-0.7757214,7.785944\n839958696496853,-7.73806,-0.45010993,3.2944214\n839958761506228,-8.0924015,-1.532289,4.462792\n839958826484353,-9.519346,-1.2162545,0.32561144\n839958891493728,-9.471462,-2.882619,4.4340615\n839958956503103,-8.322245,-3.0933087,-1.934515\n839959021512478,-11.386824,-2.6719291,-1.0151415\n839959086492165,-8.207323,-5.3438582,-0.9959879\n839959151501540,-3.7732618,-6.6079965,-5.793968\n839959216510915,-5.793968,-5.1523223,-2.231396\n839959281489040,-11.87524,-2.0111294,-2.7868507\n839959346498415,-9.969456,-10.04607,3.323152\n839959411507790,-3.9073372,-9.002198,-4.3766007\n839959476485915,-2.4612393,-7.776367,-1.484405\n839959541495290,-4.2042184,-5.6120086,-4.4819455\n839959606506228,-1.685518,-3.5338416,-1.0534488\n839959671482790,-5.315128,-20.475212,2.9879637\n839959736493728,-0.05746084,-8.255207,7.201759\n839959801503103,1.9440918,-10.773908,0.7374141\n839959866512478,-0.7757214,-9.835381,2.566584\n839959931490603,-1.1013328,-9.653421,2.3654714\n839959996501540,-1.8579005,-9.481039,1.3311762\n839960061510915,-2.1739352,-9.624691,2.0590134\n839960126489040,-2.7006595,-9.414001,2.480393\n839960191498415,-2.384625,-9.222465,1.9728222\n839960256507790,-1.6759412,-9.471462,1.3503298\n839960321485915,-1.8579005,-10.266336,1.1013328\n839960386495290,-2.2697031,-10.553641,-2.6910827\n839960451506228,-0.51714754,-10.180145,-4.0318356\n839960516484353,0.6991069,-14.116213,-2.6527755\n839960581492165,0.46926352,-8.935161,4.6255975\n839960646503103,-1.436521,-9.77792,-2.0398598\n839960711512478,0.12449849,-7.144298,-1.541866\n839960776490603,2.681506,-7.3549876,-1.8291701\n839960841499978,3.916914,-7.2592196,-4.501099\n839960906509353,1.9728222,-8.571242,-5.2002063\n839960971489040,2.480393,-8.485051,-5.1810527\n839961036496853,5.094861,-21.854273,-10.180145\n839961101507790,-0.7565677,2.1547816,5.3725886\n839961166485915,-0.076614454,-14.374787,6.349423\n839961231495290,-0.9576807,-11.549629,-2.767697\n839961296504665,-1.1971009,-9.193734,-0.5554548\n839961361515603,-0.641646,-9.691729,0.59376204\n839961426493728,-0.6991069,-9.069236,0.545878\n839961491503103,-1.2449849,-9.174581,0.9576807\n839961556512478,-1.340753,-10.228029,-1.4556746\n839961621490603,-2.585738,-11.21444,2.1260512\n839961686499978,-5.7748146,-14.231135,-0.79487497\n839961751509353,1.0821792,-13.120225,-4.903325\n839961816487478,-1.2737153,-13.67568,5.8801594\n839961881496853,4.367024,-14.240712,-8.619126\n839961946507790,-0.1340753,-5.985504,1.4748282\n839962011485915,-0.22026655,-7.3071036,1.6663644\n839962076495290,1.0342951,-5.602432,2.1930888\n839962141504665,0.7182605,-5.094861,-1.2258313\n839962206514040,2.0590134,-14.317327,-13.417107\n839962271493728,5.391742,-9.691729,-2.480393\n839962336503103,3.86903,-16.25184,-11.18571\n839962401512478,0.62249243,-3.3614593,5.889736\n839962466490603,0.02873042,-12.890382,2.825158\n839962531499978,-3.0933087,-10.46745,-1.8291701\n839962596509353,-1.9153614,-8.992621,0.7661445\n839962661489040,-0.29688102,-8.916007,0.38307226\n839962726496853,-1.1013328,-9.126697,1.5993267\n839962791507790,-0.009576807,-11.568783,-11.022904\n839962856485915,-1.7812861,-10.745177,2.5378537\n839962921495290,-3.9073372,-10.419566,0.7565677\n839962986504665,-5.66947,-12.842498,0.22026655\n839963051514040,-0.7086837,-11.808203,2.6144683\n839963116492165,1.0342951,-15.016433,5.1906295\n839963181503103,2.2122424,-10.5919485,-3.064578\n839963246512478,-1.934515,-6.349423,1.6759412\n839963311490603,-0.05746084,-6.8091097,1.1875241\n839963376499978,0.82360536,-4.721366,2.2601264\n839963441509353,0.60333884,-6.9623384,-7.517793\n839963506487478,3.8307228,-14.585477,-7.297527\n839963571496853,12.593501,-14.355634,-8.149862\n839963636507790,-2.1739352,0.92895025,6.8091097\n839963701484353,1.1300632,-13.8480625,8.983045\n839963766495290,-2.078167,-14.642938,-6.4547677\n839963831504665,-1.436521,-8.743625,3.0550013\n839963896515603,0.45968673,-8.456321,-0.842759\n839963961492165,-1.3503298,-9.021352,2.1547816\n839964026501540,-0.62249243,-10.477027,-0.63206923\n839964091512478,-1.3790601,-10.601525,3.217807\n839964156490603,-3.3614593,-10.888829,0.7374141\n839964221499978,-6.1866174,-14.18325,-4.721366\n839964286509353,-0.47884035,-10.888829,-0.9576807\n839964351487478,1.7525556,-17.209522,6.2249246\n839964416496853,2.1068976,-11.080365,-0.58418524\n839964481506228,-1.292869,-5.813122,1.1204864\n839964546484353,-1.4748282,-6.3781533,2.1068976\n839964611493728,1.388637,-5.1810527,3.016694\n839964676504665,1.3024458,-7.192182,-5.391742\n839964741514040,3.6296098,-15.131354,-9.136273\n839964806492165,7.3645644,-7.431602,-2.815581\n839964871501540,1.3024458,-5.48751,13.493721\n839964936512478,2.7006595,-7.575254,7.795521\n839965001489040,-1.4556746,-17.630901,1.8100165\n839965066498415,-1.043872,-9.136273,2.1547816\n839965131509353,-0.7469909,-8.178593,-1.0534488\n839965196487478,-1.1683705,-9.653421,1.0630256\n839965261496853,-0.5746084,-8.983045,0.35434186\n839965326506228,0.16280572,-10.630256,0.1436521\n839965391484353,-3.371036,-11.128249,1.292869\n839965456493728,-5.2959743,-14.738706,-4.2999864\n839965521504665,-0.7374141,-11.070788,-3.4572272\n839965586514040,0.6895301,-16.050728,6.4547677\n839965651492165,2.327164,-11.262324,-5.90889\n839965716501540,-1.0247183,-4.9416323,0.02873042\n839965781510915,-1.532289,-7.2783732,2.087744\n839965846489040,2.4612393,-6.1770406,2.1930888\n839965911498415,2.1452048,-6.1100025,-3.5625722\n839965976509353,3.169923,-14.958972,-11.252748\n839966041487478,5.8705826,-9.097966,-4.0222588\n839966106496853,5.9280434,-10.869676,6.9527617\n839966171506228,2.566584,-4.5777135,-2.0590134\n839966236484353,-1.13964,-15.629349,3.122039\n839966301493728,-2.4899697,-9.940725,1.6184803\n839966366504665,-1.436521,-8.379706,-1.043872\n839966431514040,-0.076614454,-9.624691,0.2681506\n839966496492165,-0.46926352,-9.299079,0.46926352\n839966561501540,-0.1436521,-10.333375,-1.0534488\n839966626510915,-2.8443117,-10.91756,0.90979666\n839966691489040,-3.3423057,-10.371682,-1.5993267\n839966756498415,-2.834735,-13.666103,-3.6104562\n839966821509353,-0.81402856,-11.760319,5.9759274\n839966886487478,4.7500963,-16.338032,1.7142484\n839966951496853,1.5801731,-7.52737,3.9839516\n839967016506228,-0.9959879,-6.9719152,1.1204864\n839967081484353,-0.34476504,-7.297527,1.5227122\n839967146493728,1.6089035,-5.267244,0.22026655\n839967211503103,0.019153614,-9.835381,-11.176133\n839967276514040,3.7445314,-10.70687,-4.060566\n839967341492165,12.382812,-15.552734,-7.086837\n839967406501540,-1.9440918,0.29688102,6.6654577\n839967471510915,-0.38307226,-12.74673,6.215348\n839967536489040,-3.2465374,-11.722012,-6.3781533\n839967601498415,-0.9576807,-9.414001,1.1013328\n839967666507790,-0.5746084,-9.193734,-0.47884035\n839967731485915,-1.3599066,-9.270349,1.1779473\n839967796495290,-0.40222588,-9.892841,1.0534488\n839967861506228,-0.51714754,-10.630256,1.2162545\n839967926484353,-3.8498764,-10.955867,0.8331822\n839967991493728,-4.3861775,-16.021997,-1.4077905\n839968056503103,-2.719813,-9.452309,4.663905\n839968121512478,3.715801,-18.65562,6.5505357\n839968186492165,2.1930888,-8.628703,3.3423057\n839968251501540,-0.59376204,-6.3685765,0.019153614\n839968316510915,-1.532289,-6.0525417,1.532289\n839968381489040,2.4899697,-5.2289367,1.3120226\n839968446498415,2.2409728,-9.576807,-11.348516\n839968511507790,2.9400797,-10.764331,-5.257667\n839968576485915,8.475474,-17.860744,-10.419566\n839968641495290,-0.34476504,-1.340753,5.6120086\n839968706506228,-1.2162545,-12.066776,4.146757\n839968771484353,-2.9975405,-10.534488,-4.405331\n839968836493728,-1.6663644,-9.433155,-0.93852705\n839968901503103,-0.17238252,-9.490616,-0.80445176\n839968966512478,0.20111294,-9.730036,0.842759\n839969031490603,0.17238252,-9.002198,-0.39264908\n839969096499978,-0.4213795,-10.888829,2.0590134\n839969161510915,-2.585738,-10.716447,0.78529817\n839969226489040,-1.9728222,-13.9917145,-2.96881\n839969291498415,0.8619126,-9.911995,4.213795\n839969356507790,7.7093296,-18.83758,4.1276035\n839969421485915,4.606444,-7.967903,3.5913026\n839969486495290,1.4748282,-4.3766007,2.3942018\n839969551504665,-0.46926352,-6.1866174,0.93852705\n839969616484353,2.566584,-14.164097,-6.981492\n839969681493728,2.6240451,-8.848969,0.0\n839969746503103,4.003105,-11.291056,0.2873042\n839969811512478,3.4284968,-7.5561004,-0.5363012\n839969876490603,1.8387469,-8.42759,1.283292\n839969941499978,0.842759,-11.224017,0.05746084\n839970006510915,1.4173675,-9.911995,0.6799533\n839970071489040,2.8443117,-9.902418,1.9057846\n839970136498415,4.855441,-8.963891,0.0\n839970201507790,1.8291701,-9.672575,2.5378537\n839970266485915,2.2888567,-8.542512,-1.1204864\n839970331495290,7.52737,-11.080365,-5.439626\n839970396506228,-0.35434186,-9.251195,-0.18195933\n839970461484353,4.8937483,-4.453215,7.642292\n839970526493728,-0.51714754,-9.586384,-2.719813\n839970591503103,2.9592333,-9.787497,-1.6280571\n839970656514040,4.31914,-8.532935,-1.8579005\n839970721490603,2.2218192,-8.494628,-0.80445176\n839970786499978,-0.095768064,-11.827356,2.0494366\n839970851509353,3.1507695,-9.002198,4.865018\n839970916487478,4.6351743,-10.371682,-1.4173675\n839970981496853,4.261679,-10.007763,2.030283\n839971046507790,3.9935284,-9.481039,0.17238252\n839971111485915,-0.15322891,-9.270349,2.3463178\n839971176495290,2.0398598,-9.174581,1.8483237\n839971241504665,-0.90021986,-10.620679,0.4213795\n839971306514040,-1.2449849,-10.563218,-0.38307226\n839971371492165,-1.3599066,-11.36767,3.6966474\n839971436503103,-4.2425256,-10.630256,-2.9113493\n839971501512478,-2.6719291,-11.84651,1.388637\n839971566490603,-0.17238252,-11.061212,-2.1452048\n839971631499978,-4.0222588,-9.165004,0.038307227\n839971696510915,-3.1028855,-9.481039,-0.63206923\n839971761487478,-5.315128,-6.2345014,-1.1300632\n839971826498415,-6.291962,-8.2169,-1.5035586\n839971891507790,-6.1866174,-7.728483,0.076614454\n839971956485915,-6.2249246,-6.8569937,-0.32561144\n839972021495290,-5.1810527,-7.0102224,1.2737153\n839972086504665,-7.9104424,-6.885724,0.90979666\n839972151514040,-8.418014,-7.0581064,2.7389667\n839972216492165,-10.448297,-5.4779334,2.834735\n839972281503103,-12.382812,-2.9975405,1.9728222\n839972346512478,-10.927136,-0.08619126,3.2369606\n839972411490603,-10.821792,2.0111294,4.012682\n839972476499978,-3.3806129,4.644751,0.50757074\n839972541509353,-6.4068837,-2.5953147,10.515334\n839972606487478,-4.7405195,1.091756,7.843405\n839972671496853,-3.5625722,1.5705963,9.260772\n839972736507790,-3.4955344,1.0342951,9.643845\n839972801485915,-0.29688102,3.1794999,8.121132\n839972866495290,0.095768064,2.681506,6.6367273\n839972931504665,-1.0151415,3.1124623,9.509769\n839972996514040,-0.36391866,3.5625722,8.331821\n839973061492165,-1.7429788,5.1810527,5.995081\n839973126503103,-0.1436521,2.480393,10.630256\n839973191512478,-0.4309563,3.763685,7.153875\n839973256489040,0.21068975,2.9592333,10.189722\n839973321499978,-0.60333884,4.213795,7.920019\n839973386509353,0.21068975,3.6391866,9.375694\n839973451487478,-0.9959879,4.654328,8.350976\n839973516496853,-0.2681506,4.0701427,8.7532015\n839973581507790,-1.2545617,4.453215,9.126697\n");

    assertEquals(14, runStepCounterOnData(data));
  }

  @Test
  public void fastSteps_12() {
    String data =
        String.format(
            "timestamp,x,y,z\n840042091498415,-1.3120226,-0.15322891,7.374141\n840042156509353,-0.842759,-0.7374141,8.724471\n840042221487478,-0.9864111,-0.45968673,8.647857\n840042286496853,-0.16280572,-1.6280571,10.362105\n840042351506228,-1.5993267,-1.8291701,9.797073\n840042416484353,-1.2545617,-2.2122424,9.615114\n840042481493728,-0.9768343,-2.777274,8.772355\n840042546503103,-4.1946416,-1.043872,6.895301\n840042611512478,-8.963891,-1.0151415,10.486604\n840042676492165,-6.9144545,-0.33518824,3.5913026\n840042741501540,-7.4986396,-2.3750482,5.851429\n840042806510915,-9.021352,-2.3080103,1.5801731\n840042871489040,-9.5385,-3.4955344,3.4284968\n840042936499978,-10.515334,-3.8019924,-3.0071173\n840043001507790,-6.895301,-5.813122,0.39264908\n840043066487478,-4.9416323,-6.8091097,-2.7102363\n840043131496853,-8.781932,-4.999093,-0.23942018\n840043196506228,-8.169016,-8.63828,2.2218192\n840043261484353,-8.169016,-7.9966335,-2.327164\n840043326493728,-7.3549876,-10.007763,-1.292869\n840043391504665,-2.6719291,-4.951209,0.095768064\n840043456514040,-3.5913026,-6.7612257,1.9057846\n840043521492165,-6.244078,-11.827356,-1.685518\n840043586501540,-5.363012,-11.779472,-6.2728086\n840043651510915,0.45968673,-8.590396,6.991069\n840043716489040,-1.4173675,-9.605537,2.5474305\n840043781498415,-2.6240451,-9.519346,0.2873042\n840043846509353,-3.1507695,-9.050082,2.7102363\n840043911485915,-3.8498764,-8.590396,3.323152\n840043976495290,-2.7006595,-9.270349,2.9975405\n840044041506228,-2.3463178,-8.992621,0.038307227\n840044106484353,-3.7253778,-8.6095495,2.4612393\n840044171493728,-3.6870706,-8.255207,1.8291701\n840044236503103,-3.2273839,-8.580819,2.3558946\n840044301512478,-4.0701427,-10.199299,4.3287168\n840044366492165,-4.8458643,-11.63582,3.2273839\n840044431501540,-7.776367,-14.18325,-4.999093\n840044496510915,-5.841852,-10.955867,-0.39264908\n840044561489040,-3.2848446,-14.489709,4.5777135\n840044626498415,-2.834735,-11.453861,-2.7006595\n840044691507790,-4.1276035,-5.2002063,3.41892\n840044756487478,0.08619126,-5.48751,4.357447\n840044821495290,-0.2777274,-2.2505496,-1.8770541\n840044886506228,0.94810385,-17.429789,-15.02601\n840044951484353,-2.4516625,-16.261417,0.51714754\n840045016493728,0.5363012,-2.8634653,5.7843914\n840045081503103,0.47884035,-15.02601,3.3997664\n840045146512478,-6.3302693,-12.220005,4.654328\n840045211490603,-4.357447,-8.6095495,3.265691\n840045276501540,-0.5554548,-7.97748,-9.14585\n840045341510915,-7.2113357,-11.559206,2.2218192\n840045406489040,-10.103531,-8.39886,-5.8705826\n840045471498415,-5.889736,-14.030022,-3.41892\n840045536507790,-2.7964275,-18.44493,5.6215854\n840045601485915,2.5570073,-16.654066,-2.2505496\n840045666496853,-1.2162545,-2.2984335,3.9743748\n840045731506228,-1.2545617,-3.0262709,2.825158\n840045796484353,-1.0055647,-1.5514427,2.4899697\n840045861493728,7.1730285,-23.740904,-19.603724\n840045926503103,3.9935284,-9.988609,9.672575\n840045991512478,1.6376339,-8.561666,4.960786\n840046056492165,-5.0182467,-14.441825,4.9895163\n840046121501540,-4.5681367,-10.553641,2.873042\n840046186510915,-2.7006595,-6.9240313,-2.834735\n840046251489040,-2.6527755,-8.42759,0.545878\n840046316498415,-0.80445176,-11.712435,-3.7541082\n840046381507790,-4.596867,-12.785037,-0.92895025\n840046446485915,-9.873688,-15.342045,-1.4077905\n840046511495290,-4.185065,-10.390836,5.00867\n840046576504665,0.7661445,-21.911734,4.6351743\n840046641482790,0.32561144,-9.050082,4.855441\n840046706493728,-2.1260512,-2.777274,3.1794999\n840046771503103,-0.21068975,-3.371036,3.4476504\n840046836512478,1.0342951,-4.1371803,0.22026655\n840046901490603,6.5218053,-20.38902,-11.760319\n840046966499978,5.1523223,-11.099519,8.628703\n840047031510915,-0.009576807,-5.659893,5.899313\n840047096489040,-4.5872903,-16.156073,4.9320555\n840047161498415,-4.654328,-10.342952,1.7142484\n840047226507790,-2.1068976,-8.475474,1.733402\n840047291485915,-2.0973208,-7.0581064,-0.21068975\n840047356495290,-2.9400797,-12.53604,-3.1316159\n840047421506228,-5.3438582,-12.966996,-0.8810662\n840047486514040,-7.8529816,-15.50485,-3.7924154\n840047551493728,-4.7884035,-10.67814,4.999093\n840047616503103,2.5378537,-22.76407,7.153875\n840047681512478,-0.33518824,-7.383718,4.003105\n840047746490603,-1.8866309,-2.7006595,3.6487634\n840047811499978,-0.15322891,-3.763685,4.510676\n840047876509353,0.40222588,-5.363012,-2.9017725\n840047941487478,4.060566,-17.832014,-10.773908\n840048006498415,3.371036,-9.643845,4.663905\n840048071507790,1.6376339,-5.841852,7.785944\n840048136485915,-2.72939,-15.456966,4.2042184\n840048201495290,-4.7500963,-10.084377,1.4077905\n840048266504665,-3.1507695,-8.341399,2.1164744\n840048331514040,-2.4612393,-7.9870567,-0.35434186\n840048396492165,-4.3861775,-10.965444,-0.5363012\n840048461503103,-7.192182,-12.29662,-2.480393\n840048526510915,-5.2959743,-13.254301,-6.1387334\n840048591490603,-3.7253778,-14.422671,6.531382\n840048656498415,3.016694,-21.4712,5.6120086\n840048721509353,-0.17238252,-4.405331,4.5777135\n840048786487478,-1.9536686,-2.087744,2.7485435\n840048851496853,0.22026655,-2.6240451,3.9360676\n840048916507790,1.7525556,-18.20551,-24.17186\n840048981485915,5.0278234,-7.52737,0.6991069\n840049046495290,3.1316159,-5.9663506,3.265691\n840049111504665,0.5554548,-10.984597,9.442732\n840049176515603,-3.8019924,-14.978126,1.4173675\n840049241492165,-4.3861775,-7.1634517,-10.91756\n840049306501540,-2.480393,-8.389283,0.9768343\n840049371512478,-1.4939818,-8.494628,-0.29688102\n840049436490603,-1.8483237,-11.712435,0.8331822\n840049501499978,-7.1059904,-12.717999,-4.9703627\n840049566509353,-2.9400797,-11.21444,-2.7581203\n840049631487478,-1.0151415,-16.002844,6.7803793\n840049696496853,3.8977604,-16.16565,-3.2465374\n840049761506228,-0.6895301,-3.6583402,3.217807\n840049826484353,-2.96881,-3.3614593,3.3423057\n840049891493728,-1.1204864,-1.6567876,4.146757\n840049956504665,6.7803793,-24.238897,-29.103916\n840050021514040,2.834735,-5.995081,0.50757074\n840050086492165,0.20111294,-16.117765,14.432248\n840050151503103,-2.566584,-6.253655,8.513782\n840050216512478,0.7757214,-17.99482,-4.654328\n840050281490603,0.19153613,-6.6079965,-2.6719291\n840050346499978,-2.1452048,-8.389283,-1.4939818\n840050411509353,0.25857377,-11.300632,-4.5202527\n840050476487478,2.3558946,-8.686164,-0.2681506\n840050541496853,-1.292869,-10.448297,-0.37349546\n840050606506228,-1.0342951,-9.672575,0.05746084\n840050671485915,-1.0055647,-9.758766,1.1683705\n840050736493728,0.545878,-9.605537,1.6280571\n840050801504665,1.0247183,-9.902418,0.6703765\n840050866514040,0.48841715,-9.682152,0.82360536\n840050931492165,0.11492168,-9.308656,0.7374141\n840050996501540,0.08619126,-9.969456,0.60333884\n840051061510915,-0.5267244,-9.605537,0.9672575\n840051126489040,-0.90021986,-9.251195,1.5131354\n840051191498415,0.30645782,-10.218452,1.4460979\n840051256509353,1.3120226,-9.701305,1.4460979\n840051321487478,-0.05746084,-9.615114,0.80445176\n840051386496853,-0.6607997,-9.950302,1.436521\n840051451506228,0.22984336,-9.758766,1.0630256\n840051516484353,0.36391866,-9.844957,0.9768343\n840051581493728,0.4405331,-9.576807,1.6472107\n840051646504665,0.2777274,-9.768343,1.7046716\n840051711514040,0.32561144,-9.548077,1.8866309\n840051776492165,0.39264908,-9.682152,1.3120226\n840051841501540,-0.18195933,-9.519346,0.62249243\n840051906510915,-0.2681506,-10.505757,1.3599066\n840051971489040,0.24899697,-9.739613,2.0015526\n840052036499978,0.24899697,-9.835381,0.94810385\n840052101509353,-0.047884032,-9.3661175,1.8483237\n840052166487478,0.08619126,-9.653421,1.3503298\n840052231496853,0.12449849,-9.816227,1.8004397\n840052296506228,0.02873042,-10.065224,1.484405\n840052361484353,-0.5746084,-9.136273,0.9959879\n840052426493728,-0.2681506,-9.423578,1.7046716\n840052491504665,-0.10534488,-9.509769,1.2162545\n840052556512478,-0.38307226,-9.519346,1.5035586\n840052621492165,0.1340753,-9.873688,1.2162545\n840052686501540,0.45968673,-8.628703,1.1971009\n840052751510915,0.39264908,-9.825804,0.8714894\n840052816489040,-0.05746084,-9.069236,0.89064306\n840052881498415,0.7661445,-10.0748005,0.7565677\n840052946509353,-0.009576807,-9.212888,1.8291701\n840053011487478,-3.0933087,-10.955867,0.7661445\n840053076495290,1.4460979,-11.109096,4.759673\n840053141506228,4.213795,-7.3549876,1.1204864\n840053206484353,1.4748282,-10.5440645,-2.0111294\n840053271493728,-3.4284968,-9.030929,2.4037786\n840053336503103,1.4269443,-10.25676,0.16280572\n840053401512478,2.5953147,-9.3182335,-0.15322891\n840053466490603,2.5761611,-8.983045,-1.5131354\n840053531501540,2.5570073,-9.548077,-1.5705963\n840053596510915,2.2409728,-10.055647,0.35434186\n840053661489040,2.2505496,-10.5440645,-0.19153613\n840053726498415,-0.58418524,-9.452309,-1.9632454\n840053791507790,-1.4652514,-9.557653,0.7469909\n840053856487478,-0.2777274,-9.299079,-1.4173675\n840053921495290,-1.8004397,-9.605537,0.58418524\n840053986506228,0.17238252,-12.047623,1.733402\n840054051484353,-0.89064306,-10.802638,-2.882619\n840054116493728,-0.08619126,-12.5264635,2.336741\n840054181504665,-2.2026656,-9.931149,-3.821146\n840054246512478,-0.21068975,-10.936713,-1.9728222\n840054311490603,-5.401319,-8.791509,0.46926352\n840054376501540,-3.1124623,-8.839393,-2.1164744\n840054441510915,-4.9895163,-8.6574335,0.08619126\n840054506489040,-4.4915223,-9.921572,-2.8921957\n840054571498415,-4.261679,-10.199299,-0.8810662\n840054636507790,-4.2521024,-8.456321,-0.11492168\n840054701485915,-5.985504,-7.97748,-0.90979666\n840054766495290,-6.2728086,-8.255207,-0.12449849\n840054831504665,-7.7093296,-8.034941,-0.7278373\n840054896484353,-8.724471,-6.3206925,1.733402\n840054961493728,-11.674128,-2.8634653,0.6991069\n840055026503103,-11.195287,0.038307227,1.2162545\n840055091512478,-9.165004,1.2641385,2.078167\n840055156490603,-8.925584,0.8714894,5.305551\n840055221499978,-9.595961,0.92895025,8.523358\n840055286510915,-3.265691,-1.1587936,11.492168\n840055351489040,-3.3997664,0.8714894,9.710882\n840055416498415,-4.1180267,-0.16280572,11.310209\n840055481507790,-1.7812861,2.0111294,9.270349\n840055546487478,-1.6089035,1.2258313,8.1402855\n840055611495290,0.0,-1.1204864,9.021352\n840055676504665,-1.3024458,1.283292,8.523358\n840055741484353,-0.6512229,1.0630256,10.7356\n840055806493728,1.1109096,0.80445176,7.3549876\n840055871503103,0.05746084,0.6991069,10.572795\n840055936512478,1.0055647,1.4652514,9.605537\n840056001492165,0.48841715,1.6759412,9.481039\n840056066499978,0.6799533,1.6567876,8.513782\n840056131509353,0.4309563,2.078167,10.381259\n840056196487478,0.5554548,1.3982137,10.084377\n840056261498415,-0.009576807,1.5131354,8.571242\n840056326507790,0.06703765,1.5897499,10.141838\n840056391485915,0.842759,1.9153614,9.375694\n840056456495290,0.7469909,1.3024458,10.333375\n840056521504665,0.5267244,1.2545617,9.595961\n840056586515603,0.30645782,1.3120226,9.950302\n840056651492165,0.39264908,2.183512,9.672575\n840056716503103,0.30645782,1.2066777,10.007763\n840056781512478,0.45010993,1.7621324,8.714894\n840056846490603,0.24899697,1.1683705,10.093954\n");

    assertEquals(12, runStepCounterOnData(data));
  }

  @Test
  public void slowSteps_12() {
    String data =
        String.format(
            "timestamp,x,y,z\n840010826507790,-1.2258313,2.5091233,8.896853\n840010891485915,-1.6567876,2.633622,9.557653\n840010956495290,-2.8921957,2.681506,7.97748\n840011021504665,-1.8962077,1.292869,7.4507556\n840011086514040,-0.61291564,-0.81402856,9.299079\n840011151492165,-0.038307227,0.33518824,3.1316159\n840011216503103,-1.4748282,-1.0342951,11.348516\n840011281512478,-1.6376339,-0.82360536,5.7269306\n840011346490603,-2.3175871,-1.0055647,12.172121\n840011411499978,-3.0262709,-0.50757074,9.662998\n840011476509353,-3.5625722,0.0,13.206416\n840011541487478,-4.012682,-0.4213795,14.231135\n840011606540603,-1.8674773,-1.5897499,11.568783\n840011671506228,-2.9017725,-0.79487497,10.802638\n840011736484353,-5.765238,-0.038307227,7.3645644\n840011801493728,-9.797073,0.1436521,7.441179\n840011866504665,-10.28549,-0.6512229,-3.4380736\n840011931514040,-8.992621,-1.8195933,4.175488\n840011996492165,-8.781932,-2.5091233,0.009576807\n840012061503103,-7.201759,-3.2465374,-0.076614454\n840012126510915,-8.532935,-7.28795,-1.8483237\n840012191490603,-10.01734,-4.414908,-4.9224787\n840012256498415,-5.717354,-9.56723,-0.5363012\n840012321509353,-5.813122,-4.9703627,-5.305551\n840012386487478,-3.821146,-2.6048915,-1.7525556\n840012451496853,-2.2505496,-4.9320555,-0.5554548\n840012516507790,-3.6870706,-33.154903,2.135628\n840012581484353,-2.1452048,-5.353435,0.91937345\n840012646495290,3.3039982,-8.312668,3.5434184\n840012711504665,3.169923,-10.7356,0.25857377\n840012776514040,1.9440918,-9.940725,-0.7757214\n840012841492165,-0.20111294,-10.1226845,0.7182605\n840012906501540,1.4939818,-10.400413,-4.865018\n840012971510915,2.327164,-13.369223,-4.5298295\n840013036489040,3.8786068,-8.456321,2.1260512\n840013101498415,0.79487497,-9.394848,-1.5227122\n840013166509353,2.2218192,-7.699753,-2.384625\n840013231487478,3.9935284,-6.742072,-3.371036\n840013296496853,4.9416323,-6.0716953,-4.4340615\n840013361506228,4.0892963,-7.383718,-4.663905\n840013426485915,3.6296098,-6.8569937,-4.280833\n840013491493728,5.5737014,-6.9527617,-5.0661306\n840013556504665,13.982138,-16.49126,-11.903971\n840013621514040,2.4612393,2.7006595,2.6048915\n840013686492165,0.9768343,-13.129802,3.323152\n840013751501540,2.3750482,-11.626244,-1.4460979\n840013816510915,3.5625722,-8.829816,-1.484405\n840013881489040,0.6991069,-9.509769,-1.283292\n840013946498415,-0.22984336,-9.356541,-1.388637\n840014011509353,1.0821792,-9.998186,-1.9057846\n840014076487478,0.6799533,-10.036493,0.4309563\n840014141496853,0.8714894,-7.9870567,-0.31603462\n840014206506228,-0.545878,-10.055647,0.78529817\n840014271484353,-0.59376204,-11.463438,1.5801731\n840014336493728,-2.0494366,-10.065224,-1.5897499\n840014401504665,-1.9249382,-12.143391,-6.991069\n840014466514040,0.05746084,-11.808203,3.4476504\n840014531492165,4.960786,-15.868769,-2.2888567\n840014596501540,1.043872,-8.762778,0.7278373\n840014661510915,0.6512229,-8.1402855,1.2449849\n840014726489040,2.1068976,-6.2632318,0.2777274\n840014791498415,0.5746084,-6.655881,-0.59376204\n840014856509353,0.9959879,-7.2592196,-4.213795\n840014921487478,3.6966474,-9.56723,-5.257667\n840014986496853,5.7269306,-8.714894,-5.410896\n840015051506228,9.528923,-7.1730285,-12.440272\n840015116484353,0.7469909,-4.280833,9.212888\n840015181493728,2.1164744,-7.2304893,4.9703627\n840015246503103,0.79487497,-14.796166,-2.3080103\n840015311512478,2.2218192,-9.050082,-0.095768064\n840015376490603,0.61291564,-9.691729,-0.90979666\n840015441501540,-0.51714754,-9.452309,-0.6991069\n840015506510915,0.25857377,-9.088389,-0.25857377\n840015571489040,0.06703765,-8.446744,2.1643584\n840015636498415,1.532289,-11.434708,-3.763685\n840015701507790,-1.340753,-11.540052,2.9783869\n840015766485915,-1.6567876,-10.25676,-0.545878\n840015831495290,-3.821146,-12.794614,1.2641385\n840015896506228,1.0534488,-11.702858,3.86903\n840015961484353,4.9895163,-14.623784,0.16280572\n840016026493728,1.3503298,-10.726024,1.2449849\n840016091503103,0.16280572,-8.101978,2.0207062\n840016156512478,1.6089035,-6.1004257,0.2873042\n840016221492165,1.8579005,-4.721366,0.19153613\n840016286501540,1.5993267,-5.93762,-4.309563\n840016351510915,2.9975405,-10.553641,-6.4739213\n840016416489040,5.602432,-9.270349,-4.3478703\n840016481498415,14.30775,-11.741165,-10.151415\n840016546507790,-2.0207062,0.7086837,12.564771\n840016611485915,5.861006,-10.5919485,8.063671\n840016676495290,-0.47884035,-15.801731,1.4556746\n840016741506228,0.5746084,-9.844957,0.038307227\n840016806484353,-0.32561144,-8.695741,-1.2449849\n840016871493728,0.038307227,-8.839393,0.5363012\n840016936503103,-0.095768064,-8.935161,1.5705963\n840017001512478,1.7429788,-9.452309,-3.1794999\n840017066490603,-0.7565677,-10.94629,0.9768343\n840017131499978,-2.6144683,-9.595961,1.283292\n840017196510915,-5.6982,-13.168109,4.4436383\n840017261489040,4.654328,-12.976573,1.541866\n840017326498415,4.711789,-13.656527,1.541866\n840017391507790,2.2409728,-13.215993,1.7717092\n840017456485915,1.7238252,-10.505757,1.2066777\n840017521495290,1.0342951,-6.7708025,0.40222588\n840017586504665,0.78529817,-4.8458643,-0.095768064\n840017651482790,1.0055647,-3.4763808,-1.484405\n840017716492165,3.217807,-8.303091,-5.257667\n840017781503103,5.3821654,-10.1226845,-5.544971\n840017846512478,7.2592196,-4.7884035,-4.7884035\n840017911490603,4.261679,-10.390836,6.0142345\n840017976499978,-0.5746084,-0.91937345,-1.9057846\n840018041510915,-0.16280572,-18.454506,-5.707777\n840018106489040,1.388637,-8.772355,-1.1013328\n840018171498415,0.6703765,-10.601525,-1.1971009\n840018236507790,1.0726024,-8.887277,-1.4269443\n840018301485915,0.24899697,-8.916007,-0.50757074\n840018366495290,0.5650316,-9.835381,-0.16280572\n840018431504665,0.38307226,-8.379706,1.0055647\n840018496514040,0.038307227,-10.6398325,-2.633622\n840018561492165,-1.8866309,-10.180145,1.685518\n840018626503103,-3.620033,-10.553641,1.1875241\n840018691512478,-0.019153614,-15.71554,2.633622\n840018756490603,5.659893,-12.564771,5.7843914\n840018821499978,7.422025,-13.962984,1.4556746\n840018886509353,3.5338416,-6.7708025,4.309563\n840018951487478,-1.8483237,-3.6008794,3.4955344\n840019016498415,-0.11492168,-8.446744,1.043872\n840019081507790,2.9975405,-11.87524,-2.0398598\n840019146485915,3.0454245,-6.2823853,6.4547677\n840019211495290,4.606444,-10.658986,0.32561144\n840019276504665,1.8291701,-10.70687,-3.8115692\n840019341514040,0.82360536,-9.883265,4.223372\n840019406492165,1.7142484,-9.002198,0.82360536\n840019471503103,2.1164744,-10.170568,-0.36391866\n840019536512478,4.4244847,-9.921572,-0.2681506\n840019601490603,4.271256,-8.935161,2.4037786\n840019666499978,0.92895025,-10.390836,-0.11492168\n840019731509353,-2.384625,-9.77792,2.8634653\n840019796489040,8.00621,-12.191275,1.1300632\n840019861496853,4.405331,-8.42759,3.0262709\n840019926507790,3.1028855,-9.825804,-0.31603462\n840019991485915,0.79487497,-10.180145,2.0111294\n840020056495290,3.371036,-8.686164,-1.7525556\n840020121504665,4.9895163,-9.586384,-1.0726024\n840020186514040,5.0757074,-8.868123,-1.5610195\n840020251492165,4.5202527,-7.603985,-1.0534488\n840020316503103,0.8810662,-9.260772,-2.3750482\n840020381512478,2.4708161,-10.726024,-0.45010993\n840020446490603,2.384625,-9.921572,1.5514427\n840020511499978,-0.545878,-9.519346,-2.327164\n840020576509353,0.50757074,-9.299079,0.40222588\n840020641487478,0.10534488,-10.534488,0.40222588\n840020706496853,2.1643584,-8.868123,-2.480393\n840020771507790,-0.11492168,-10.457873,1.3599066\n840020836485915,-0.8714894,-10.333375,-1.3694834\n840020901495290,1.0630256,-12.411542,3.3135753\n840020966504665,-1.0534488,-10.247183,-4.654328\n840021031514040,-0.94810385,-10.0748005,0.05746084\n840021096493728,-4.5872903,-8.255207,-1.0534488\n840021161501540,-4.4244847,-10.907983,-0.2681506\n840021226510915,-6.129156,-9.232041,-0.5363012\n840021291489040,-3.8881836,-8.992621,1.4652514\n840021356498415,-8.1402855,-8.485051,-2.5378537\n840021421509353,-9.3182335,-8.379706,4.0701427\n840021486487478,-11.769896,-6.2345014,0.2681506\n840021551496853,-8.820239,0.46926352,5.5258174\n840021616506228,-7.5848308,0.7086837,9.940725\n840021681485915,-4.0701427,-2.0398598,12.220005\n840021746495290,-4.4819455,1.6184803,9.80665\n840021811504665,-2.5953147,-0.6607997,10.409989\n840021876514040,-3.8786068,-0.25857377,10.754754\n840021941492165,-1.6089035,0.25857377,9.758766\n840022006501540,-2.8060043,2.930503,7.5465236\n840022071510915,-1.0247183,1.6472107,8.350976\n840022136489040,-1.7046716,2.2984335,8.073248\n840022201498415,-2.1547816,2.3750482,8.858546\n840022266509353,-1.1587936,2.480393,8.149862\n840022331487478,-1.6472107,2.5474305,9.490616\n840022396496853,-1.8387469,3.1507695,9.289502\n840022461506228,-1.934515,3.41892,8.580819\n840022526484353,-1.1683705,3.217807,7.6710224\n");

    assertEquals(12, runStepCounterOnData(data));
  }

  @Test
  public void smallSteps_10() {
    String data =
        String.format(
            "timestamp,x,y,z\n840171431495290,-1.3024458,-1.2737153,10.67814\n840171496506228,-0.45968673,-1.0342951,8.00621\n840171561484353,-1.6184803,-1.0342951,7.776367\n840171626493728,-3.1028855,-0.9768343,8.552089\n840171691504665,-1.3982137,-2.3463178,9.442732\n840171756512478,-3.2848446,-0.1340753,9.3661175\n840171821490603,-6.0046577,-0.31603462,10.860099\n840171886503103,-6.157887,-0.6607997,8.810662\n840171951510915,-8.283937,-1.436521,8.6095495\n840172016489040,-6.090849,-1.292869,4.5298295\n840172081498415,-10.304645,-1.6759412,7.479486\n840172146507790,-9.136273,-1.733402,1.1971009\n840172211485915,-10.43872,-3.265691,4.6255975\n840172276496853,-8.762778,-3.964798,3.6774938\n840172341506228,-9.959879,-1.4173675,2.4229321\n840172406484353,-8.848969,-2.7485435,3.5913026\n840172471493728,-9.911995,-0.9959879,-0.49799395\n840172536503103,-9.385271,-1.091756,-1.484405\n840172601512478,-9.078813,-2.5187001,0.30645782\n840172666490603,-10.477027,-2.3750482,-4.9416323\n840172731501540,-4.4340615,-7.422025,-1.0055647\n840172796510915,-8.446744,-6.83784,-5.755661\n840172861489040,-8.37013,-5.142745,0.48841715\n840172926498415,-6.981492,-8.226477,-3.1794999\n840172991507790,-8.935161,-9.356541,-6.38773\n840173056485915,-3.7541082,-7.4603324,-5.1523223\n840173121495290,-3.2465374,-4.4915223,-4.175488\n840173186504665,-5.0661306,-3.4955344,-1.13964\n840173251484353,-1.8483237,-4.4340615,1.8387469\n840173316493728,-8.896853,-24.71774,-0.61291564\n840173381503103,-0.7182605,-7.632715,3.466804\n840173446512478,2.327164,-9.624691,2.528277\n840173511490603,2.0015526,-10.94629,-3.4763808\n840173576501540,1.685518,-9.509769,2.1068976\n840173641510915,0.41180268,-9.490616,1.2066777\n840173706489040,-0.6991069,-9.548077,1.0151415\n840173771498415,-1.484405,-10.409989,1.9919758\n840173836507790,-2.0015526,-9.548077,1.1109096\n840173901485915,-1.6184803,-9.835381,-2.5570073\n840173966495290,-1.2162545,-9.56723,1.484405\n840174031504665,-0.50757074,-10.697293,-0.10534488\n840174096484353,-0.7565677,-10.362105,0.40222588\n840174161493728,-2.815581,-14.240712,-0.2777274\n840174226503103,0.7565677,-10.620679,-4.146757\n840174291512478,1.5705963,-9.481039,7.747637\n840174356490603,-0.5363012,-12.641385,-2.5761611\n840174421499978,0.46926352,-7.795521,1.1013328\n840174486510915,1.5897499,-7.240066,-0.02873042\n840174551489040,2.6048915,-6.14831,-1.5801731\n840174616496853,2.1068976,-10.611102,-6.5601125\n840174681507790,2.1547816,-9.471462,-1.3790601\n840174746485915,2.5474305,-12.670115,1.8770541\n840174811495290,1.2066777,-7.1730285,3.9552212\n840174876504665,0.5554548,-9.356541,0.095768064\n840174941514040,-2.1930888,-9.950302,0.34476504\n840175006492165,-1.0630256,-8.858546,0.5554548\n840175071503103,0.23942018,-9.816227,-0.4309563\n840175136512478,0.8714894,-9.739613,-2.0590134\n840175201490603,-0.641646,-11.358093,-0.7469909\n840175266499978,-1.4652514,-15.763424,-4.3382936\n840175331510915,2.3080103,-10.25676,-1.5514427\n840175396489040,2.7964275,-12.612655,2.5091233\n840175461496853,-0.93852705,-9.155427,1.340753\n840175526507790,0.8714894,-7.297527,1.091756\n840175591485915,2.4133554,-6.090849,2.585738\n840175656495290,2.72939,-6.3589997,-2.6623523\n840175721504665,1.6280571,-13.637373,-9.414001\n840175786514040,2.8921957,-8.916007,3.3039982\n840175851492165,1.4173675,-8.6574335,1.3024458\n840175916501540,1.2354081,-7.8912888,2.8538885\n840175981512478,-0.7757214,-12.909535,-2.432509\n840176046490603,-0.009576807,-9.375694,0.7661445\n840176111499978,-0.02873042,-9.548077,0.5650316\n840176176509353,0.49799395,-10.228029,-2.1643584\n840176241487478,0.11492168,-11.013328,-0.9576807\n840176306496853,-2.1930888,-15.638926,-2.135628\n840176371507790,4.8267107,-10.0748005,-2.633622\n840176436485915,2.0111294,-12.77546,4.5777135\n840176501495290,0.9959879,-8.724471,1.484405\n840176566504665,0.41180268,-6.6079965,1.436521\n840176631514040,1.8483237,-7.0006456,1.5514427\n840176696492165,3.3901896,-6.0046577,-0.6895301\n840176761501540,2.4037786,-15.389929,-10.141838\n840176826512478,4.1659107,-9.5385,5.1906295\n840176891490603,0.7565677,-5.7365074,3.5913026\n840176956499978,0.8331822,-10.409989,1.6950948\n840177021509353,-1.8483237,-10.419566,-2.6719291\n840177086487478,-0.06703765,-8.916007,1.1779473\n840177151496853,0.82360536,-9.643845,0.0\n840177216507790,-0.18195933,-10.572795,0.45010993\n840177281484353,0.7565677,-10.199299,-1.9440918\n840177346495290,-1.283292,-11.702858,-1.7046716\n840177411504665,-0.37349546,-12.4785795,-4.5681367\n840177476514040,-0.076614454,-9.299079,6.349423\n840177541492165,3.0550013,-15.140931,-7.5465236\n840177606501540,0.90979666,-6.579266,1.4748282\n840177671510915,1.1013328,-7.1059904,1.292869\n840177736489040,3.169923,-6.943185,0.47884035\n840177801498415,2.5761611,-7.7572136,-5.0182467\n840177866509353,2.4037786,-12.852075,-8.169016\n840177931487478,2.6527755,-8.446744,0.8331822\n840177996496853,4.654328,-13.311762,-6.8761473\n840178061507790,2.0494366,-5.602432,3.7828386\n840178126485915,0.7278373,-12.785037,1.0821792\n840178191495290,-1.685518,-10.036493,-2.4037786\n840178256504665,-0.8523358,-8.00621,1.7525556\n840178321514040,0.17238252,-9.720459,0.41180268\n840178386492165,2.1068976,-10.7356,-2.920926\n840178451501540,-0.90979666,-10.965444,-0.7757214\n840178516510915,-1.1300632,-16.232687,-3.6966474\n840178581490603,2.2122424,-10.218452,2.9496565\n840178646499978,3.7062242,-13.091495,0.9864111\n840178711509353,-0.2681506,-7.7093296,2.1452048\n840178776487478,0.82360536,-6.435614,-0.15322891\n840178841496853,2.5570073,-6.5122285,1.043872\n840178906506228,3.1794999,-6.7324953,-2.834735\n840178971484353,3.2369606,-12.852075,-8.954314\n840179036493728,3.620033,-7.5944076,-1.7142484\n840179101504665,5.3342814,-16.960526,-4.050989\n840179166514040,0.63206923,-5.947197,5.2480903\n840179231492165,-0.8331822,-12.210428,1.388637\n840179296501540,0.7086837,-10.247183,-1.9536686\n840179361510915,1.6950948,-9.605537,-0.842759\n840179426489040,0.59376204,-10.726024,-1.7621324\n840179491499978,1.733402,-9.9790325,1.4269443\n840179556509353,1.0342951,-9.883265,-0.047884032\n840179621487478,0.4309563,-10.25676,1.0534488\n840179686496853,0.62249243,-8.734048,1.2066777\n840179751506228,3.4093432,-11.291056,2.0590134\n840179816484353,1.6280571,-9.059659,0.047884032\n840179881493728,1.3120226,-9.80665,0.31603462\n840179946503103,1.7142484,-9.14585,2.2026656\n840180011512478,2.6144683,-9.902418,0.32561144\n840180076492165,2.135628,-9.710882,0.019153614\n840180141501540,1.7142484,-9.56723,0.019153614\n840180206510915,3.0358477,-10.237606,-1.0821792\n840180271489040,2.9017725,-9.059659,-3.0454245\n840180336498415,2.087744,-10.113108,-0.1436521\n840180401509353,1.1683705,-10.409989,-1.3120226\n840180466487478,3.1411927,-9.174581,-1.8387469\n840180531496853,2.4037786,-9.490616,-0.30645782\n840180596506228,1.3024458,-9.710882,-2.719813\n840180661484353,1.541866,-9.605537,-1.5514427\n840180726493728,-0.63206923,-10.208876,-1.5227122\n840180791503103,0.5267244,-9.260772,-1.6567876\n840180856512478,0.41180268,-6.895301,-2.6431987\n840180921492165,-0.4213795,-10.486604,-1.541866\n840180986501540,0.15322891,-9.56723,-2.8060043\n840181051510915,1.0342951,-9.509769,-1.6184803\n840181116489040,0.12449849,-9.452309,-1.0342951\n840181181498415,0.2681506,-9.739613,-1.2258313\n840181246507790,0.17238252,-9.730036,-1.3024458\n840181311485915,-0.02873042,-10.199299,-1.0342951\n840181376495290,-1.043872,-9.155427,0.019153614\n840181441506228,-0.17238252,-9.892841,1.3311762\n840181506484353,-2.030283,-11.492168,-0.39264908\n840181571493728,-1.5035586,-9.375694,-0.82360536\n840181636503103,-2.4229321,-9.749189,-0.29688102\n840181701514040,-3.7924154,-9.385271,-0.7086837\n840181766492165,-5.046977,-8.236053,-1.0821792\n840181831501540,-3.3806129,-8.935161,-1.1013328\n840181896510915,-4.213795,-8.599973,-1.8674773\n840181961489040,-3.9552212,-9.883265,-1.3215994\n840182026498415,-5.315128,-9.069236,-1.2737153\n840182091507790,-6.7229185,-9.615114,-1.2737153\n840182156485915,-6.2249246,-9.184157,-1.292869\n840182221496853,-3.916914,-9.509769,-1.8004397\n840182286506228,-6.799533,-8.178593,-0.4309563\n840182351484353,-10.084377,-7.1347213,-1.5131354\n840182416493728,-12.200851,-3.5817258,-1.982399\n840182481503103,-12.421119,1.436521,5.2863975\n840182546512478,-8.169016,2.9879637,7.5944076\n840182611490603,-9.490616,1.8962077,8.523358\n840182676501540,-2.834735,1.2545617,6.157887\n840182741510915,-2.815581,0.79487497,10.486604\n840182806489040,-2.9975405,0.641646,8.523358\n840182871498415,-2.432509,-0.92895025,11.18571\n840182936507790,-1.4652514,0.7565677,9.394848\n840183001485915,-3.7828386,1.4748282,8.39886\n840183066496853,-1.6184803,0.08619126,10.831368\n840183131504665,-2.432509,2.834735,8.935161\n840183196484353,-1.4748282,2.4708161,7.201759\n840183261492165,-1.6567876,2.9496565,7.7189064\n840183326503103,-0.9959879,3.0358477,8.63828\n840183391512478,-1.3982137,2.3750482,9.950302\n840183456490603,0.076614454,1.532289,9.193734\n840183521499978,-0.2681506,2.7485435,9.835381\n840183586510915,0.25857377,2.72939,9.069236\n840183651489040,-0.7374141,3.3423057,9.720459\n840183716498415,0.15322891,3.122039,9.768343\n840183781507790,-0.047884032,3.074155,8.121132\n");

    assertEquals(10, runStepCounterOnData(data));
  }
}
